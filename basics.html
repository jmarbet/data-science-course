<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Science - 2&nbsp; Basic Concepts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./decisiontrees.html" rel="next">
<link href="./intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html">Overview and Methods</a></li><li class="breadcrumb-item"><a href="./basics.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Basic Concepts</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="./Data-Science.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About this Course</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Overview and Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Basic Concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./decisiontrees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Decision Trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./neuralnetworks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Neural Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./additional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Additional Methods</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./applicationI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Loan Default Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./applicationII.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">House Price Prediction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#linear-regression-in-a-ml-context" id="toc-linear-regression-in-a-ml-context" class="nav-link active" data-scroll-target="#linear-regression-in-a-ml-context"><span class="header-section-number">2.1</span> Linear Regression in a ML Context</a></li>
  <li><a href="#logistic-regression-in-a-ml-context" id="toc-logistic-regression-in-a-ml-context" class="nav-link" data-scroll-target="#logistic-regression-in-a-ml-context"><span class="header-section-number">2.2</span> Logistic Regression in a ML Context</a></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation"><span class="header-section-number">2.3</span> Model Evaluation</a>
  <ul class="collapse">
  <li><a href="#regression-models" id="toc-regression-models" class="nav-link" data-scroll-target="#regression-models"><span class="header-section-number">2.3.1</span> Regression Models</a></li>
  <li><a href="#classification-models" id="toc-classification-models" class="nav-link" data-scroll-target="#classification-models"><span class="header-section-number">2.3.2</span> Classification Models</a></li>
  </ul></li>
  <li><a href="#generalization-and-overfitting" id="toc-generalization-and-overfitting" class="nav-link" data-scroll-target="#generalization-and-overfitting"><span class="header-section-number">2.4</span> Generalization and Overfitting</a>
  <ul class="collapse">
  <li><a href="#bias-variance-tradeoff" id="toc-bias-variance-tradeoff" class="nav-link" data-scroll-target="#bias-variance-tradeoff"><span class="header-section-number">2.4.1</span> Bias-Variance Tradeoff</a></li>
  <li><a href="#regularization" id="toc-regularization" class="nav-link" data-scroll-target="#regularization"><span class="header-section-number">2.4.2</span> Regularization</a></li>
  <li><a href="#training-validation-and-test-datasets" id="toc-training-validation-and-test-datasets" class="nav-link" data-scroll-target="#training-validation-and-test-datasets"><span class="header-section-number">2.4.3</span> Training, Validation, and Test Datasets</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation"><span class="header-section-number">2.4.4</span> Cross-Validation</a></li>
  </ul></li>
  <li><a href="#python-implementation" id="toc-python-implementation" class="nav-link" data-scroll-target="#python-implementation"><span class="header-section-number">2.5</span> Python Implementation</a></li>
  </ul>
<div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html"><i class="bi bi-link-45deg"></i>Scikit-Learn: Logistic Regression</a></li></ul></div><div class="quarto-code-links"><h2>Code Links</h2><ul><li><a href="notebooks/basic_concepts.ipynb"><i class="bi bi-file-code"></i>Download Jupyter Notebook</a></li><li><a href="https://colab.research.google.com/github/jmarbet/data-science-course/blob/main/notebooks/basic_concepts.ipynb"><i class="bi bi-file-code"></i>Open Jupyter Notebook in Google Colab</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html">Overview and Methods</a></li><li class="breadcrumb-item"><a href="./basics.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Basic Concepts</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Basic Concepts</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Now that we have a basic understanding of what machine learning is, letâ€™s dive into some concepts that are essential for understanding machine learning models. The <strong>focus</strong> of this section will be on <strong>supervised learning</strong> models. We will start with placing linear regression and logistic regression in a machine-learning context. We will then discuss how to evaluate regression and classification models and introduce the concepts of generalization and overfitting. Finally, we will implement some of these concepts in Python.</p>
<section id="linear-regression-in-a-ml-context" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="linear-regression-in-a-ml-context"><span class="header-section-number">2.1</span> Linear Regression in a ML Context</h2>
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linear-regression-interactive-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="26" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 25;"><span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">//</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> randomDataRange <span class="op">=</span> [<span class="op">-</span><span class="dv">4</span><span class="op">,</span> <span class="dv">4</span>]<span class="op">;</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> lossRange <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">11</span>]<span class="op">;</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Generate random data</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> seed <span class="op">=</span> <span class="fl">0.25160386911120525</span><span class="op">;</span> <span class="co">// a number in [0,1)</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> source <span class="op">=</span> d3<span class="op">.</span><span class="fu">randomLcg</span>(seed)<span class="op">;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> randn <span class="op">=</span> d3<span class="op">.</span><span class="at">randomNormal</span><span class="op">.</span><span class="fu">source</span>(source)(<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> xTmp <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">100</span>}<span class="op">,</span> randn)<span class="op">;</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> yTmp <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">100</span>}<span class="op">,</span> randn)<span class="op">;</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> randomData <span class="op">=</span> <span class="fu">prepareData</span>(xTmp<span class="op">,</span> yTmp)<span class="op">;</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">prepareData</span>(xTmp<span class="op">,</span> yTmp) {</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> data <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> xTmp<span class="op">.</span><span class="at">length</span><span class="op">;</span> i <span class="op">+=</span> <span class="dv">1</span>) {</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> dataPoint <span class="op">=</span> {<span class="st">"x"</span><span class="op">:</span> xTmp[i]<span class="op">,</span> <span class="st">"y"</span><span class="op">:</span> xTmp[i] <span class="op">+</span> yTmp[i]}<span class="op">;</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>            data<span class="op">.</span><span class="fu">push</span>(dataPoint)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data<span class="op">;</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Loss function</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">sumOfSquares</span>(slope) {</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> randomData<span class="op">.</span><span class="at">length</span><span class="op">;</span> i <span class="op">+=</span> <span class="dv">1</span>) {</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>            sum <span class="op">+=</span> (randomData[i]<span class="op">.</span><span class="at">y</span> <span class="op">-</span> slope <span class="op">*</span> randomData[i]<span class="op">.</span><span class="at">x</span>) <span class="op">**</span> <span class="dv">2</span> <span class="op">/</span> randomData<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">computeLossCurve</span>(inputRange) {</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> loss <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> N <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">100</span><span class="op">;</span> i <span class="op">+=</span> <span class="dv">1</span>) {</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> x <span class="op">=</span> inputRange[<span class="dv">0</span>] <span class="op">+</span> i <span class="op">*</span> (inputRange[<span class="dv">1</span>] <span class="op">-</span> inputRange[<span class="dv">0</span>])<span class="op">/</span><span class="dv">100</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> dataPoint <span class="op">=</span> {<span class="st">"x"</span><span class="op">:</span> x<span class="op">,</span> <span class="st">"y"</span><span class="op">:</span> <span class="fu">sumOfSquares</span>(x)}<span class="op">;</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>            loss<span class="op">.</span><span class="fu">push</span>(dataPoint)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> loss<span class="op">;</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Data for regression line</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> slopeData <span class="op">=</span> [</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">x</span><span class="op">:</span> (slope <span class="op">&gt;</span> <span class="dv">1</span> <span class="op">||</span> slope <span class="op">&lt;</span> <span class="op">-</span><span class="dv">1</span>)  <span class="op">?</span> randomDataRange[<span class="dv">0</span>]<span class="op">/</span>slope <span class="op">:</span> randomDataRange[<span class="dv">0</span>]<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> (slope <span class="op">&gt;</span> <span class="dv">1</span> <span class="op">||</span> slope <span class="op">&lt;</span> <span class="op">-</span><span class="dv">1</span>)  <span class="op">?</span> randomDataRange[<span class="dv">0</span>] <span class="op">:</span> randomDataRange[<span class="dv">0</span>]<span class="op">*</span>slope}<span class="op">,</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">x</span><span class="op">:</span> (slope <span class="op">&gt;</span> <span class="dv">1</span> <span class="op">||</span> slope <span class="op">&lt;</span> <span class="op">-</span><span class="dv">1</span>)  <span class="op">?</span> randomDataRange[<span class="dv">1</span>]<span class="op">/</span>slope <span class="op">:</span> randomDataRange[<span class="dv">1</span>]<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> (slope <span class="op">&gt;</span> <span class="dv">1</span> <span class="op">||</span> slope <span class="op">&lt;</span> <span class="op">-</span><span class="dv">1</span>)  <span class="op">?</span> randomDataRange[<span class="dv">1</span>] <span class="op">:</span> randomDataRange[<span class="dv">1</span>]<span class="op">*</span>slope}</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">;</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Data for loss marker</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> markerData <span class="op">=</span> [</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">x</span><span class="op">:</span> slope<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fu">sumOfSquares</span>(slope) }</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">;</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Data for loss curve</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> lossCurveData <span class="op">=</span> <span class="fu">computeLossCurve</span>(inputRange)<span class="op">;</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sets <span class="op">=</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">;</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;div style="display:flex; flex-wrap: wrap;"&gt;</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>sets</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((index) <span class="kw">=&gt;</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marginTop</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>            <span class="dt">width</span><span class="op">:</span> width <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>            <span class="dt">height</span><span class="op">:</span> width <span class="op">/</span> <span class="dv">3</span> <span class="op">-</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> randomDataRange <span class="op">:</span> inputRange<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="st">"x"</span> <span class="op">:</span> <span class="st">"Weight"</span>}<span class="op">,</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> randomDataRange <span class="op">:</span> lossRange<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="st">"y"</span> <span class="op">:</span> <span class="st">"Loss"</span>}<span class="op">,</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>                Plot<span class="op">.</span><span class="fu">frame</span>()<span class="op">,</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>                index <span class="op">===</span> <span class="dv">1</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>                    <span class="op">?</span> Plot<span class="op">.</span><span class="fu">dot</span>(randomData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"steelblue"</span>})</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>                    <span class="op">:</span> Plot<span class="op">.</span><span class="fu">line</span>(lossCurveData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"steelblue"</span>})<span class="op">,</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>                index <span class="op">===</span> <span class="dv">1</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>                    <span class="op">?</span> Plot<span class="op">.</span><span class="fu">line</span>(slopeData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span>})</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>                    <span class="op">:</span> Plot<span class="op">.</span><span class="fu">dot</span>(markerData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span> <span class="dt">r</span><span class="op">:</span> <span class="dv">6</span>})<span class="op">,</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>                Plot<span class="op">.</span><span class="fu">text</span>([index]<span class="op">,</span> {</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> (randomDataRange[<span class="dv">1</span>] <span class="op">+</span> randomDataRange[<span class="dv">0</span>])<span class="op">/</span><span class="dv">2</span> <span class="op">:</span> (inputRange[<span class="dv">1</span>] <span class="op">+</span> inputRange[<span class="dv">0</span>])<span class="op">/</span><span class="dv">2</span><span class="op">,</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y</span><span class="op">:</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> ((randomDataRange[<span class="dv">1</span>] <span class="op">-</span> randomDataRange[<span class="dv">0</span>]) <span class="op">*</span> <span class="fl">0.1</span> <span class="op">+</span> randomDataRange[<span class="dv">1</span>]) <span class="op">:</span> ((lossRange[<span class="dv">1</span>] <span class="op">-</span> lossRange[<span class="dv">0</span>]) <span class="op">*</span> <span class="fl">0.1</span> <span class="op">+</span> lossRange[<span class="dv">1</span>])<span class="op">,</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">text</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="st">"Data + Regression Line"</span> <span class="op">:</span> <span class="st">"Mean Squared Error (MSE)"</span><span class="op">,</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"middle"</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>            ]<span class="op">,</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>            <span class="dt">nice</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">flat</span>()<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="127" data-source-offset="-2808"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 126;"><span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>inputRange <span class="op">=</span> [<span class="op">-</span><span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>]<span class="op">;</span></span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>viewof slope <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(inputRange<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Weight (w)"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linear-regression-interactive-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: Interactive Linear Regression With a Single Feature <span class="math inline">\(x\)</span> (i.e., <span class="math inline">\(m=1\)</span>) and Bias <span class="math inline">\(b=0\)</span>
</figcaption>
</figure>
<p>You have already extensively studied linear regressions in the statistics and econometrics course, so we will not discuss it in much detail. In machine learning, it is common to talk about <strong>weights <span class="math inline">\(w_i\)</span> and biases <span class="math inline">\(b_i\)</span></strong> instead of coefficients <span class="math inline">\(\beta_i\)</span> and intercept <span class="math inline">\(\beta_0\)</span>, i.e., the linear regression model would be written as</p>
<p><span class="math display">\[y_n = b + \sum_{i=1}^m w_i x_{i,n} + \varepsilon_n \qquad n=1,\ldots,N\]</span></p>
<p>where <span class="math inline">\(w_i\)</span> are the weights, <span class="math inline">\(b\)</span> is the bias and <span class="math inline">\(N\)</span> is the sample size. The weights and biases are found by <strong>minimizing the empirical risk function or mean squared error (MSE) loss</strong>, which is a measure of how well the model fits the data.</p>
<p><span class="math display">\[\text{MSE}(y,x; w, b) = \frac{1}{N}\sum_{n=1}^N (y_n - \hat{y}_n)^2\]</span></p>
<p>where <span class="math inline">\(y_n\)</span> is the true value, <span class="math inline">\(\hat{y}_n\)</span> is the predicted (or fitted) value for observation <span class="math inline">\(n\)</span>.</p>
<p>In the case of linear regression, there is a closed-form solution for the weights and biases that minimize the MSE. However, the <strong>weights and biases have to be found numerically in many other machine learning models</strong> since there is no closed-form solution. One can think of this, as the machine learning algorithm automatically moving a slider for the slope <a href="#fig-linear-regression-interactive" class="quarto-xref">Figure&nbsp;<span>2.2</span></a> until the loss is minimized (i.e., the red dot is at the lowest possible point) and the model fits the data as well as possible.</p>
</section>
<section id="logistic-regression-in-a-ml-context" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="logistic-regression-in-a-ml-context"><span class="header-section-number">2.2</span> Logistic Regression in a ML Context</h2>
<p>Logistic regression is a widely used <strong>classification model</strong> <span class="math inline">\(p(y|x;w,b)\)</span> where <span class="math inline">\(x\in \mathbb{R}^m\)</span> is an input vector, and <span class="math inline">\(y\in\{0,1,\ldots,C\}\)</span> is a class label. We will focus on the binary case, meaning that <span class="math inline">\(y\in\{0,1\}\)</span> but it is also possible to extend this to more than two classes. The probability that <span class="math inline">\(y_n\)</span> is equal to <span class="math inline">\(1\)</span> for observation <span class="math inline">\(n\)</span> is given by <span class="math display">\[p(y_n=1|x_n;w,b)= \frac{1}{1+\exp(-b-\sum_{i=1}^m w_i x_{i,n})}\]</span></p>
<p>where <span class="math inline">\(w=[w_1, \ldots, w_n]'\in \mathbb{R}^m\)</span> is a weight vector, and <span class="math inline">\(b\)</span> is a bias term. Combining the probabilities for each observation <span class="math inline">\(n\)</span>, we can write the <strong>likelihood function</strong> as</p>
<p><span class="math display">\[\mathcal{L}(w,b) = \prod_{n=1}^N p(y_n=1|x_n;w,b)^{y_n} \left(1-p(y_n=1|x_n;w,b)\right)^{1-y_n}\]</span></p>
<p>or taking the natural logarithm of the likelihood function, we get the <strong>log-likelihood function</strong></p>
<p><span class="math display">\[\log\mathcal{L}(w,b) = \sum_{n=1}^N y_n \log p(y_n=1|x_n;w,b) + (1-y_n) \log \left(1-p(y_n=1|x_n;w,b)\right).\]</span></p>
<p>To find the weights and biases, we need to numerically maximize the log-likelihood function (or minimize <span class="math inline">\(-\log\mathcal{L}(w,b)\)</span>).</p>
<p>Adding a <strong>classification threshold</strong> <span class="math inline">\(t\)</span> to a logistic regression yields a <strong>decision rule</strong> of the form</p>
<p><span class="math display">\[\hat{y}=1 \Leftrightarrow p(y=1|x;w,b) &gt; t,\]</span></p>
<p>i.e., the model predicts that <span class="math inline">\(y=1\)</span> if <span class="math inline">\(p(y=1|x;w,b) &gt; t\)</span>.</p>
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-logistic-regression-interactive-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="214" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 213;"><span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>    <span class="co">//</span></span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> randomDataRange <span class="op">=</span> [<span class="op">-</span><span class="dv">2</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">;</span></span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> loglikelihoodRange <span class="op">=</span> [<span class="op">-</span><span class="dv">20</span><span class="op">,</span> <span class="op">-</span><span class="dv">8</span>]<span class="op">;</span></span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Generate random data</span></span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> seed <span class="op">=</span> <span class="fl">0.25160386911120525</span><span class="op">;</span> <span class="co">// a number in [0,1)</span></span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> source <span class="op">=</span> d3<span class="op">.</span><span class="fu">randomLcg</span>(seed)<span class="op">;</span></span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> rand <span class="op">=</span> d3<span class="op">.</span><span class="at">randomUniform</span><span class="op">.</span><span class="fu">source</span>(source)()<span class="op">;</span></span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> xTmp <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">100</span>}<span class="op">,</span> rand)<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> <span class="dv">4</span><span class="op">*</span>x<span class="op">-</span><span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> pTmp <span class="op">=</span> xTmp<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span><span class="dv">8</span><span class="op">*</span>x)))<span class="op">;</span></span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> cTmp <span class="op">=</span> xTmp<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> (<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>slope2<span class="op">*</span>x)) <span class="op">&gt;=</span> thresholdValue) <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">0</span>)<span class="op">;</span> <span class="co">// Classification based on threshold and slope2</span></span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> yTmp <span class="op">=</span> pTmp<span class="op">.</span><span class="fu">map</span>((p) <span class="kw">=&gt;</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">1</span>}<span class="op">,</span> rand)[<span class="dv">0</span>] <span class="op">&lt;</span> p <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> randomData <span class="op">=</span> <span class="fu">prepareData</span>(xTmp<span class="op">,</span> yTmp<span class="op">,</span> cTmp)<span class="op">;</span></span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">prepareData</span>(xTmp<span class="op">,</span> yTmp<span class="op">,</span> cTmp) {</span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> data <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> xTmp<span class="op">.</span><span class="at">length</span><span class="op">;</span> i <span class="op">+=</span> <span class="dv">1</span>) {</span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> dataPoint <span class="op">=</span> {<span class="st">"x"</span><span class="op">:</span> xTmp[i]<span class="op">,</span> <span class="st">"y"</span><span class="op">:</span> yTmp[i]<span class="op">,</span> <span class="st">"class"</span><span class="op">:</span> cTmp[i]}<span class="op">;</span></span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>            data<span class="op">.</span><span class="fu">push</span>(dataPoint)</span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data<span class="op">;</span></span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Regression line</span></span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> regData <span class="op">=</span> <span class="fu">computeLogisticRegressionLine</span>(slope2<span class="op">,</span> randomDataRange<span class="op">,</span> <span class="dv">100</span>)</span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">computeLogisticRegressionLine</span>(slope<span class="op">,</span> inputRange<span class="op">,</span> N) {</span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> data <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> N<span class="op">;</span> i <span class="op">+=</span> <span class="dv">1</span>) {</span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> x <span class="op">=</span> inputRange[<span class="dv">0</span>] <span class="op">+</span> i <span class="op">*</span> (inputRange[<span class="dv">1</span>] <span class="op">-</span> inputRange[<span class="dv">0</span>])<span class="op">/</span><span class="dv">100</span><span class="op">;</span></span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> dataPoint <span class="op">=</span> {<span class="st">"x"</span><span class="op">:</span> x<span class="op">,</span> <span class="st">"y"</span><span class="op">:</span> <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>slope<span class="op">*</span>x))}<span class="op">;</span></span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a>            data<span class="op">.</span><span class="fu">push</span>(dataPoint)<span class="op">;</span></span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data<span class="op">;</span></span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Log-likelihood function</span></span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">computeLogLikelihood</span>(slope<span class="op">,</span> data) {</span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> loglikelihood <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> data<span class="op">.</span><span class="at">length</span><span class="op">;</span> i <span class="op">+=</span> <span class="dv">1</span>) {</span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a>            loglikelihood <span class="op">+=</span> data[i]<span class="op">.</span><span class="at">y</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">log</span>(<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>slope<span class="op">*</span>data[i]<span class="op">.</span><span class="at">x</span>))) <span class="op">+</span> (<span class="dv">1</span><span class="op">-</span>data[i]<span class="op">.</span><span class="at">y</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">log</span>(<span class="dv">1</span><span class="op">-</span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>slope<span class="op">*</span>data[i]<span class="op">.</span><span class="at">x</span>)))<span class="op">;</span></span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> loglikelihood<span class="op">;</span></span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">computeLossCurve</span>(inputRange<span class="op">,</span> data<span class="op">,</span> N) {</span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> loss <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> N<span class="op">;</span> i <span class="op">+=</span> <span class="dv">1</span>) {</span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> x <span class="op">=</span> inputRange[<span class="dv">0</span>] <span class="op">+</span> i <span class="op">*</span> (inputRange[<span class="dv">1</span>] <span class="op">-</span> inputRange[<span class="dv">0</span>])<span class="op">/</span><span class="dv">100</span><span class="op">;</span></span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> dataPoint <span class="op">=</span> {<span class="st">"x"</span><span class="op">:</span> x<span class="op">,</span> <span class="st">"y"</span><span class="op">:</span> <span class="fu">computeLogLikelihood</span>(x<span class="op">,</span> data)}<span class="op">;</span></span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a>            loss<span class="op">.</span><span class="fu">push</span>(dataPoint)<span class="op">;</span></span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> loss<span class="op">;</span></span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> loglikelihoodCurveData <span class="op">=</span> <span class="fu">computeLossCurve</span>(inputRange2<span class="op">,</span> randomData<span class="op">,</span> <span class="dv">100</span>)<span class="op">;</span></span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> markerData <span class="op">=</span> [</span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">x</span><span class="op">:</span> slope2<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fu">computeLogLikelihood</span>(slope2<span class="op">,</span> randomData) }</span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">;</span></span>
<span id="cb3-290"><a href="#cb3-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-291"><a href="#cb3-291" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Data for threshold</span></span>
<span id="cb3-292"><a href="#cb3-292" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> threshData <span class="op">=</span> [</span>
<span id="cb3-293"><a href="#cb3-293" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">x</span><span class="op">:</span> randomDataRange[<span class="dv">0</span>]<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> thresholdValue}<span class="op">,</span></span>
<span id="cb3-294"><a href="#cb3-294" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">x</span><span class="op">:</span> randomDataRange[<span class="dv">1</span>]<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> thresholdValue}</span>
<span id="cb3-295"><a href="#cb3-295" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">;</span></span>
<span id="cb3-296"><a href="#cb3-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-297"><a href="#cb3-297" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sets <span class="op">=</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">;</span></span>
<span id="cb3-298"><a href="#cb3-298" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;div style="display:flex; flex-wrap: wrap;"&gt;</span></span>
<span id="cb3-299"><a href="#cb3-299" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>sets</span>
<span id="cb3-300"><a href="#cb3-300" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((index) <span class="kw">=&gt;</span></span>
<span id="cb3-301"><a href="#cb3-301" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb3-302"><a href="#cb3-302" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb3-303"><a href="#cb3-303" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marginTop</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span></span>
<span id="cb3-304"><a href="#cb3-304" aria-hidden="true" tabindex="-1"></a>            <span class="dt">width</span><span class="op">:</span> width <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb3-305"><a href="#cb3-305" aria-hidden="true" tabindex="-1"></a>            <span class="dt">height</span><span class="op">:</span> width <span class="op">/</span> <span class="dv">3</span> <span class="op">-</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb3-306"><a href="#cb3-306" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> [<span class="op">-</span><span class="dv">2</span><span class="op">,</span> <span class="dv">2</span>] <span class="op">:</span> inputRange2<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="st">"X"</span> <span class="op">:</span> <span class="st">"Weight"</span>}<span class="op">,</span></span>
<span id="cb3-307"><a href="#cb3-307" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>] <span class="op">:</span> loglikelihoodRange<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="st">"Y"</span> <span class="op">:</span> <span class="st">"log(L(w,b))"</span>}<span class="op">,</span></span>
<span id="cb3-308"><a href="#cb3-308" aria-hidden="true" tabindex="-1"></a>            <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb3-309"><a href="#cb3-309" aria-hidden="true" tabindex="-1"></a>                <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb3-310"><a href="#cb3-310" aria-hidden="true" tabindex="-1"></a>                <span class="dt">scheme</span><span class="op">:</span> <span class="st">"Paired"</span></span>
<span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb3-313"><a href="#cb3-313" aria-hidden="true" tabindex="-1"></a>                Plot<span class="op">.</span><span class="fu">frame</span>()<span class="op">,</span></span>
<span id="cb3-314"><a href="#cb3-314" aria-hidden="true" tabindex="-1"></a>                index <span class="op">===</span> <span class="dv">1</span></span>
<span id="cb3-315"><a href="#cb3-315" aria-hidden="true" tabindex="-1"></a>                    <span class="op">?</span> Plot<span class="op">.</span><span class="fu">dot</span>(randomData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">r</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> threshold<span class="op">.</span><span class="fu">includes</span>(<span class="st">""</span>) <span class="op">?</span> <span class="st">"class"</span> <span class="op">:</span> <span class="st">"steelblue"</span>})</span>
<span id="cb3-316"><a href="#cb3-316" aria-hidden="true" tabindex="-1"></a>                    <span class="op">:</span> Plot<span class="op">.</span><span class="fu">line</span>(loglikelihoodCurveData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"steelblue"</span>})<span class="op">,</span></span>
<span id="cb3-317"><a href="#cb3-317" aria-hidden="true" tabindex="-1"></a>                index <span class="op">===</span> <span class="dv">1</span></span>
<span id="cb3-318"><a href="#cb3-318" aria-hidden="true" tabindex="-1"></a>                    <span class="op">?</span> Plot<span class="op">.</span><span class="fu">line</span>(regData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span>})</span>
<span id="cb3-319"><a href="#cb3-319" aria-hidden="true" tabindex="-1"></a>                    <span class="op">:</span> Plot<span class="op">.</span><span class="fu">dot</span>(markerData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span> <span class="dt">r</span><span class="op">:</span> <span class="dv">6</span>})<span class="op">,</span></span>
<span id="cb3-320"><a href="#cb3-320" aria-hidden="true" tabindex="-1"></a>                threshold<span class="op">.</span><span class="fu">includes</span>(<span class="st">""</span>)</span>
<span id="cb3-321"><a href="#cb3-321" aria-hidden="true" tabindex="-1"></a>                    <span class="op">?</span> Plot<span class="op">.</span><span class="fu">line</span>(threshData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span> <span class="dt">strokeDasharray</span><span class="op">:</span> <span class="st">"10,5"</span>})</span>
<span id="cb3-322"><a href="#cb3-322" aria-hidden="true" tabindex="-1"></a>                    <span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb3-323"><a href="#cb3-323" aria-hidden="true" tabindex="-1"></a>                Plot<span class="op">.</span><span class="fu">text</span>([index]<span class="op">,</span> {</span>
<span id="cb3-324"><a href="#cb3-324" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> (randomDataRange[<span class="dv">1</span>] <span class="op">+</span> randomDataRange[<span class="dv">0</span>])<span class="op">/</span><span class="dv">2</span> <span class="op">:</span> (inputRange2[<span class="dv">1</span>] <span class="op">+</span> inputRange2[<span class="dv">0</span>])<span class="op">/</span><span class="dv">2</span><span class="op">,</span></span>
<span id="cb3-325"><a href="#cb3-325" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y</span><span class="op">:</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> ((loglikelihoodRange[<span class="dv">1</span>] <span class="op">-</span> loglikelihoodRange[<span class="dv">0</span>]) <span class="op">*</span> <span class="fl">0.1</span> <span class="op">+</span> loglikelihoodRange[<span class="dv">1</span>])<span class="op">,</span></span>
<span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">text</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> index <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="st">"Data + Regression Line"</span> <span class="op">:</span> <span class="st">"Log-Likelihood"</span><span class="op">,</span></span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"middle"</span></span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a>            ]<span class="op">,</span></span>
<span id="cb3-330"><a href="#cb3-330" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-331"><a href="#cb3-331" aria-hidden="true" tabindex="-1"></a>            <span class="dt">nice</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb3-332"><a href="#cb3-332" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb3-333"><a href="#cb3-333" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-334"><a href="#cb3-334" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">flat</span>()<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb3-335"><a href="#cb3-335" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="338" data-source-offset="-3515"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 337;"><span id="cb4-338"><a href="#cb4-338" aria-hidden="true" tabindex="-1"></a>inputRange2 <span class="op">=</span> [<span class="op">-</span><span class="dv">2</span><span class="op">,</span> <span class="dv">18</span>]<span class="op">;</span></span>
<span id="cb4-339"><a href="#cb4-339" aria-hidden="true" tabindex="-1"></a>viewof slope2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(inputRange2<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Weight (w)"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span>})</span>
<span id="cb4-340"><a href="#cb4-340" aria-hidden="true" tabindex="-1"></a>viewof threshold <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>([<span class="st">""</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Classification Threshold"</span>})</span>
<span id="cb4-341"><a href="#cb4-341" aria-hidden="true" tabindex="-1"></a>viewof thresholdValue <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span><span class="dv">1</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Threshold Value (t)"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-5" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-logistic-regression-interactive-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.3: Interactive Logistic Regression With a Single Feature <span class="math inline">\(x\)</span> (i.e., <span class="math inline">\(m=1\)</span>) and Bias <span class="math inline">\(b=0\)</span> (Classification Legend: dark blue = 1, light blue = 0)
</figcaption>
</figure>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Terminology: Regression vs.&nbsp;Classification
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do not get confused about the fact that it is called logistic <em>regression</em> but is used for classification tasks. Logistic regression provides an estimate of the probability that <span class="math inline">\(y=1\)</span> for given <span class="math inline">\(x\)</span>, i.e., an estimate for <span class="math inline">\(p(y=1|x;w,b)\)</span>. To turn, this into a classification model, we also need a <strong>classification threshold</strong> value for <span class="math inline">\(p(y=1|x;w,b)\)</span> above which we classify an observation as <span class="math inline">\(y=1\)</span>.</p>
</div>
</div>
<p><a href="#fig-logistic-regression-interactive" class="quarto-xref">Figure&nbsp;<span>2.4</span></a> shows an interactive example of a logistic regression model. The left-hand side shows the data points and the regression line. The right-hand side shows the log-likelihood function with the red dot showing the value of the log-likelihood for the current value of <span class="math inline">\(w\)</span>. The goal is to find the weight <span class="math inline">\(w\)</span> in the regression line that maximizes the log-likelihood function (we assumed <span class="math inline">\(b=0\)</span> for simplicity).</p>
<p>If you enable the classification threshold <span class="math inline">\(t\)</span>, a data point is shown as dark blue if <span class="math inline">\(p(y=1|x;w,b) &gt; t\)</span>, otherwise, it is shown in light blue. Note how the value of the threshold affects the classification of the data points for points in the middle. Essentially, for each classification threshold, we have a different classification model. But how do we choose the classification threshold? This is a topic that we will discuss in the next section.</p>
<p>Logistic regression belongs to the class of <strong>generalized linear models</strong> with logit as the link function. We could write</p>
<p><span class="math display">\[\log\left(\frac{p}{1-p}\right)= b+\sum_{i=1}^m w_i x_{i,n}\]</span></p>
<p>where <span class="math inline">\(p=p(y_n=1|x_n;w,b)\)</span>, which separates the linear part on the right-hand side from the logit on the left-hand side.</p>
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-logistic-regression-interactive-decision-boundary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="415" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 414;"><span id="cb5-415"><a href="#cb5-415" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb5-416"><a href="#cb5-416" aria-hidden="true" tabindex="-1"></a>    <span class="co">//</span></span>
<span id="cb5-417"><a href="#cb5-417" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> randomDataRange <span class="op">=</span> [<span class="op">-</span><span class="dv">2</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">;</span></span>
<span id="cb5-418"><a href="#cb5-418" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> loglikelihoodRange <span class="op">=</span> [<span class="op">-</span><span class="dv">20</span><span class="op">,</span> <span class="op">-</span><span class="dv">8</span>]<span class="op">;</span></span>
<span id="cb5-419"><a href="#cb5-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-420"><a href="#cb5-420" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Generate random data</span></span>
<span id="cb5-421"><a href="#cb5-421" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> seed <span class="op">=</span> <span class="fl">0.25160386911120525</span><span class="op">;</span> <span class="co">// a number in [0,1)</span></span>
<span id="cb5-422"><a href="#cb5-422" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> source <span class="op">=</span> d3<span class="op">.</span><span class="fu">randomLcg</span>(seed)<span class="op">;</span></span>
<span id="cb5-423"><a href="#cb5-423" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> rand <span class="op">=</span> d3<span class="op">.</span><span class="at">randomUniform</span><span class="op">.</span><span class="fu">source</span>(source)()<span class="op">;</span></span>
<span id="cb5-424"><a href="#cb5-424" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> x1Tmp <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">200</span>}<span class="op">,</span> rand)<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> (randomDataRange[<span class="dv">1</span>] <span class="op">-</span> randomDataRange[<span class="dv">0</span>]) <span class="op">*</span> x <span class="op">+</span> randomDataRange[<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb5-425"><a href="#cb5-425" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> x2Tmp <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">200</span>}<span class="op">,</span> rand)<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> (randomDataRange[<span class="dv">1</span>] <span class="op">-</span> randomDataRange[<span class="dv">0</span>]) <span class="op">*</span> x <span class="op">+</span> randomDataRange[<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb5-426"><a href="#cb5-426" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> pTmp <span class="op">=</span> x1Tmp<span class="op">.</span><span class="fu">map</span>((x1<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span><span class="fl">0.5</span> <span class="op">-</span> <span class="dv">3</span> <span class="op">*</span> x1 <span class="op">-</span> <span class="dv">4</span> <span class="op">*</span> x2Tmp[i] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(x1<span class="op">,</span> <span class="dv">2</span>))))<span class="op">;</span> <span class="co">// "True" model</span></span>
<span id="cb5-427"><a href="#cb5-427" aria-hidden="true" tabindex="-1"></a>    <span class="co">//(usSquare.includes("") ? 2 * Math.pow(x1, 2) : 0)</span></span>
<span id="cb5-428"><a href="#cb5-428" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> yTmp <span class="op">=</span> pTmp<span class="op">.</span><span class="fu">map</span>((p) <span class="kw">=&gt;</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">1</span>}<span class="op">,</span> rand)[<span class="dv">0</span>] <span class="op">&lt;</span> p <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb5-429"><a href="#cb5-429" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> randomData <span class="op">=</span> <span class="fu">prepareData</span>(yTmp<span class="op">,</span> x1Tmp<span class="op">,</span> x2Tmp)<span class="op">;</span></span>
<span id="cb5-430"><a href="#cb5-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-431"><a href="#cb5-431" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">prepareData</span>(yTmp<span class="op">,</span> x1Tmp<span class="op">,</span> x2Tmp) {</span>
<span id="cb5-432"><a href="#cb5-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-433"><a href="#cb5-433" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> data <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb5-434"><a href="#cb5-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-435"><a href="#cb5-435" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> x1Tmp<span class="op">.</span><span class="at">length</span><span class="op">;</span> i <span class="op">+=</span> <span class="dv">1</span>) {</span>
<span id="cb5-436"><a href="#cb5-436" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> dataPoint <span class="op">=</span> {<span class="st">"x1"</span><span class="op">:</span> x1Tmp[i]<span class="op">,</span> <span class="st">"x2"</span><span class="op">:</span> x2Tmp[i]<span class="op">,</span> <span class="st">"y"</span><span class="op">:</span> yTmp[i]}<span class="op">;</span></span>
<span id="cb5-437"><a href="#cb5-437" aria-hidden="true" tabindex="-1"></a>            data<span class="op">.</span><span class="fu">push</span>(dataPoint)</span>
<span id="cb5-438"><a href="#cb5-438" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-439"><a href="#cb5-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-440"><a href="#cb5-440" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data<span class="op">;</span></span>
<span id="cb5-441"><a href="#cb5-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-442"><a href="#cb5-442" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-443"><a href="#cb5-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-444"><a href="#cb5-444" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Decision boundary</span></span>
<span id="cb5-445"><a href="#cb5-445" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> regData <span class="op">=</span> <span class="fu">computeDecisionBoundary</span>(weight1<span class="op">,</span> weight2<span class="op">,</span> weight3<span class="op">,</span> bias<span class="op">,</span> <span class="fl">0.5</span><span class="op">,</span> randomDataRange<span class="op">,</span> <span class="dv">100</span>)</span>
<span id="cb5-446"><a href="#cb5-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-447"><a href="#cb5-447" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">computeDecisionBoundary</span>(w1<span class="op">,</span> w2<span class="op">,</span> w3<span class="op">,</span> b<span class="op">,</span> t<span class="op">,</span> inputRange<span class="op">,</span> N) {</span>
<span id="cb5-448"><a href="#cb5-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-449"><a href="#cb5-449" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> data <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb5-450"><a href="#cb5-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-451"><a href="#cb5-451" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> N<span class="op">;</span> i <span class="op">+=</span> <span class="dv">1</span>) {</span>
<span id="cb5-452"><a href="#cb5-452" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> x1 <span class="op">=</span> inputRange[<span class="dv">0</span>] <span class="op">+</span> i <span class="op">*</span> (inputRange[<span class="dv">1</span>] <span class="op">-</span> inputRange[<span class="dv">0</span>])<span class="op">/</span><span class="dv">100</span><span class="op">;</span></span>
<span id="cb5-453"><a href="#cb5-453" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> x2 <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>w2 <span class="op">*</span> (<span class="op">-</span>b <span class="op">-</span> w1 <span class="op">*</span> x1 <span class="op">-</span> (useSquare<span class="op">.</span><span class="fu">includes</span>(<span class="st">""</span>) <span class="op">?</span> w3 <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(x1<span class="op">,</span><span class="dv">2</span>)  <span class="op">:</span> <span class="dv">0</span>) <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">log</span>((<span class="dv">1</span><span class="op">-</span>t)<span class="op">/</span>t))<span class="op">;</span></span>
<span id="cb5-454"><a href="#cb5-454" aria-hidden="true" tabindex="-1"></a>            x2 <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(x2<span class="op">,</span> inputRange[<span class="dv">0</span>])<span class="op">,</span> inputRange[<span class="dv">1</span>])</span>
<span id="cb5-455"><a href="#cb5-455" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> c <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>b <span class="op">-</span> w1 <span class="op">*</span> x1 <span class="op">-</span> w2 <span class="op">*</span> x2 <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(x1<span class="op">,</span> <span class="dv">2</span>) <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(x1<span class="op">,</span> <span class="dv">3</span>)) <span class="op">&lt;</span> t <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb5-456"><a href="#cb5-456" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> dataPoint <span class="op">=</span> {<span class="st">"x1"</span><span class="op">:</span> x1<span class="op">,</span> <span class="st">"x2"</span><span class="op">:</span> x2<span class="op">,</span> <span class="st">"lb"</span><span class="op">:</span> inputRange[<span class="dv">0</span>]<span class="op">,</span> <span class="st">"ub"</span><span class="op">:</span> inputRange[<span class="dv">1</span>]<span class="op">,</span> <span class="st">"c0"</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="st">"c1"</span><span class="op">:</span> <span class="dv">1</span>}<span class="op">;</span></span>
<span id="cb5-457"><a href="#cb5-457" aria-hidden="true" tabindex="-1"></a>            data<span class="op">.</span><span class="fu">push</span>(dataPoint)<span class="op">;</span></span>
<span id="cb5-458"><a href="#cb5-458" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-459"><a href="#cb5-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-460"><a href="#cb5-460" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data<span class="op">;</span></span>
<span id="cb5-461"><a href="#cb5-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-462"><a href="#cb5-462" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-463"><a href="#cb5-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-464"><a href="#cb5-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-465"><a href="#cb5-465" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb5-466"><a href="#cb5-466" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb5-467"><a href="#cb5-467" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marginTop</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span></span>
<span id="cb5-468"><a href="#cb5-468" aria-hidden="true" tabindex="-1"></a>            <span class="dt">width</span><span class="op">:</span> width <span class="op">-</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb5-469"><a href="#cb5-469" aria-hidden="true" tabindex="-1"></a>            <span class="dt">height</span><span class="op">:</span> width <span class="op">*</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span> <span class="op">-</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb5-470"><a href="#cb5-470" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> randomDataRange<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"xâ‚"</span>}<span class="op">,</span></span>
<span id="cb5-471"><a href="#cb5-471" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> randomDataRange<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"xâ‚‚"</span>}<span class="op">,</span></span>
<span id="cb5-472"><a href="#cb5-472" aria-hidden="true" tabindex="-1"></a>            <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb5-473"><a href="#cb5-473" aria-hidden="true" tabindex="-1"></a>                <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb5-474"><a href="#cb5-474" aria-hidden="true" tabindex="-1"></a>                <span class="dt">scheme</span><span class="op">:</span> <span class="st">"Category10"</span></span>
<span id="cb5-475"><a href="#cb5-475" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb5-476"><a href="#cb5-476" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb5-477"><a href="#cb5-477" aria-hidden="true" tabindex="-1"></a>                Plot<span class="op">.</span><span class="fu">frame</span>()<span class="op">,</span></span>
<span id="cb5-478"><a href="#cb5-478" aria-hidden="true" tabindex="-1"></a>                Plot<span class="op">.</span><span class="fu">dot</span>(randomData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"x2"</span><span class="op">,</span> <span class="dt">r</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"y"</span>})<span class="op">,</span></span>
<span id="cb5-479"><a href="#cb5-479" aria-hidden="true" tabindex="-1"></a>                Plot<span class="op">.</span><span class="fu">areaY</span>(regData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"x2"</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> <span class="st">"lb"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"c0"</span><span class="op">,</span> <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.2</span>})<span class="op">,</span></span>
<span id="cb5-480"><a href="#cb5-480" aria-hidden="true" tabindex="-1"></a>                Plot<span class="op">.</span><span class="fu">areaY</span>(regData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"x2"</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> <span class="st">"ub"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"c1"</span><span class="op">,</span> <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.2</span>})<span class="op">,</span></span>
<span id="cb5-481"><a href="#cb5-481" aria-hidden="true" tabindex="-1"></a>                Plot<span class="op">.</span><span class="fu">line</span>(regData<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"x2"</span>})</span>
<span id="cb5-482"><a href="#cb5-482" aria-hidden="true" tabindex="-1"></a>            ]<span class="op">,</span></span>
<span id="cb5-483"><a href="#cb5-483" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-484"><a href="#cb5-484" aria-hidden="true" tabindex="-1"></a>            <span class="dt">nice</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb5-485"><a href="#cb5-485" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb5-486"><a href="#cb5-486" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="489" data-source-offset="-2380"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 488;"><span id="cb6-489"><a href="#cb6-489" aria-hidden="true" tabindex="-1"></a>viewof weight1 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">5</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Weight wâ‚"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span>})</span>
<span id="cb6-490"><a href="#cb6-490" aria-hidden="true" tabindex="-1"></a>viewof weight2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Weight wâ‚‚"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span>})</span>
<span id="cb6-491"><a href="#cb6-491" aria-hidden="true" tabindex="-1"></a>viewof bias <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Bias b"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span>})</span>
<span id="cb6-492"><a href="#cb6-492" aria-hidden="true" tabindex="-1"></a>viewof useSquare <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>([<span class="st">""</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Include square of xâ‚"</span>})</span>
<span id="cb6-493"><a href="#cb6-493" aria-hidden="true" tabindex="-1"></a>viewof weight3 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">5</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"wâ‚ƒ"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-6" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-logistic-regression-interactive-decision-boundary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.5: Decision Boundary - Logistic Regression with Features <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> (and optionally <span class="math inline">\(x_1^2\)</span>)
</figcaption>
</figure>
<p>This linearity also shows up in the <strong>linear decision boundary</strong> produced by a logistic regression in <a href="#fig-logistic-regression-interactive-decision-boundary" class="quarto-xref">Figure&nbsp;<span>2.6</span></a>. A decision boundary shows how a machine-learning model separates different classes in our data, i.e, how it would classify an arbitrary combination of <span class="math inline">\((x_1,x_2)\)</span>. This linearity of the decision boundary can pose a problem if the two classes are not linearly separable as in <a href="#fig-logistic-regression-interactive-decision-boundary" class="quarto-xref">Figure&nbsp;<span>2.6</span></a>. We can remedy this issue by including higher order terms for <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> such as <span class="math inline">\(x_2^2\)</span> or <span class="math inline">\(x_1^3\)</span>, which is a type of <strong>feature engineering</strong>. However, there are many forms of non-linearity that the decision boundary can have and we cannot try all of them. You might know the following phrase from a Tolstoy book</p>
<blockquote class="blockquote">
<p>â€œHappy families are all alike; every unhappy family is unhappy in its own way.â€</p>
</blockquote>
<p>In the context of non-linear functions, people sometimes say</p>
<blockquote class="blockquote">
<p>â€œLinear functions are all alike; every non-linear function is non-linear in its own way.â€</p>
</blockquote>
<p>During the course, we will learn more advanced machine-learning techniques that can produce non-linear decision boundaries without the need for feature engineering.</p>
</section>
<section id="model-evaluation" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="model-evaluation"><span class="header-section-number">2.3</span> Model Evaluation</h2>
<p>Suppose our machine learning model has learned the weights and biases that minimize the loss function. How do we know if the model is any good? In this section, we will discuss how to evaluate regression and classification models.</p>
<section id="regression-models" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="regression-models"><span class="header-section-number">2.3.1</span> Regression Models</h3>
<p>In the case of regression models, we can use the <strong>mean squared error (MSE)</strong> as a measure of how well the model fits the data. The MSE is defined as</p>
<p><span class="math display">\[\text{MSE} = \frac{1}{N}\sum_{n=1}^N (y_n - \hat{y}_n)^2,\]</span></p>
<p>where <span class="math inline">\(y_n\)</span> is the true value, <span class="math inline">\(\hat{y}_n\)</span> is the predicted value for observation <span class="math inline">\(n\)</span> and <span class="math inline">\(N\)</span> is the sample size. A low MSE indicates a good fit, while a high MSE indicates a poor fit. In the ideal case, the MSE is zero, meaning that the model perfectly fits the data. Related to the MSE is the <strong>root mean squared error (RMSE)</strong>, which is the square root of the MSE</p>
<p><span class="math display">\[\text{RMSE} = \sqrt{\text{MSE}}.\]</span></p>
<p>The RMSE is in the same unit as the target variable <span class="math inline">\(y\)</span> and is easier to interpret than the MSE.</p>
<p>Regression models are sometimes also evaluated based on the <strong>coefficient of determination <span class="math inline">\(R^2\)</span></strong>. The <span class="math inline">\(R^2\)</span> is defined as</p>
<p><span class="math display">\[R^2 = 1 - \frac{\sum_{n=1}^N (y_n - \hat{y}_n)^2}{\sum_{n=1}^N (y_n - \bar{y})^2},\]</span></p>
<p>where <span class="math inline">\(\bar{y}\)</span> is the mean of the true values <span class="math inline">\(y_n\)</span>. The <span class="math inline">\(R^2\)</span> is a measure of how well the model fits the data compared to a simple model that predicts the mean of the true values for all observations. The <span class="math inline">\(R^2\)</span> can take values between <span class="math inline">\(-\infty\)</span> and <span class="math inline">\(1\)</span>. A value of <span class="math inline">\(1\)</span> indicates a perfect fit, while a value of <span class="math inline">\(0\)</span> indicates that the model does not perform better than the simple model that predicts the mean of the true values for all observations. Note that the <span class="math inline">\(R^2\)</span> is a normalized version of the MSE</p>
<p><span class="math display">\[R^2 = 1 - \frac{N\times\text{MSE}}{\sum_{n=1}^N (y_n - \bar{y})^2}.\]</span></p>
<p>Thus, we would rank models based on the <span class="math inline">\(R^2\)</span> in the same way as we would rank them based on the MSE or the RMSE.</p>
<p>There are many more metrics but at this stage, we will only look at one more: the <strong>mean-absolute-error (MAE)</strong>. The MAE is defined as</p>
<p><span class="math display">\[\text{MAE} = \frac{1}{N}\sum_{n=1}^N |y_n - \hat{y}_n|.\]</span></p>
<p>The MAE is the average of the absolute differences between the true values and the predicted values. Note that the MAE does not penalize large errors as much as the MSE does.</p>
</section>
<section id="classification-models" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="classification-models"><span class="header-section-number">2.3.2</span> Classification Models</h3>
<p>In the case of classification models, we need different metrics to evaluate the performance of the model. We will discuss some of the most common metrics in the following subsections.</p>
<section id="basic-metrics" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="basic-metrics">Basic Metrics</h4>
<p>A key measure to evaluate a classification model, both binary and multiclass classification, is to look at how often it predicts the correct class. This is called the <strong>accuracy</strong> of a model <span class="math display">\[\text{Accuracy} = \frac{\text{Number of correct predictions}}{\text{Total number of predictions}}.\]</span></p>
<p>Related to this, one could also compute the <strong>misclassification rate</strong> <span class="math display">\[\text{Missclassification Rate} = \frac{\text{Number of incorrect predictions}}{\text{Total number of predictions}}.\]</span></p>
<p>While these measures are probably the most intuitive measures to assess the performance of a classification model, they <strong>can be misleading</strong> in some cases. For example, if we have a dataset with 95% of the observations in class 1 and 5% in class 0, a model that always predicts <span class="math inline">\(y=1\)</span> (class 1) would have an accuracy of 95%. However, this model would not be very useful.</p>
</section>
<section id="confusion-matrices" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="confusion-matrices">Confusion Matrices</h4>
<p>In this and the following subsection, we focus on binary classification problems.</p>
<p>Let <span class="math inline">\(\hat{y}\)</span> denote the predicted class and <span class="math inline">\(y\)</span> the true class. In a binary classification problem, we can make <strong>two types of errors</strong>. First, we can make an error because we predicted <span class="math inline">\(\hat{y}=1\)</span> when <span class="math inline">\(y=0\)</span>, which is called a <strong>false positive</strong> (or a <strong>â€œfalse alarmâ€</strong>). Sometimes this is also called a <strong>type I error</strong>. Second, we can make an error because we <span class="math inline">\(\hat{y}=0\)</span> when <span class="math inline">\(y=1\)</span>, which is called a <strong>false negative</strong> (or a <strong>â€œmissed detectionâ€</strong>). Sometimes this is referred to as a <strong>type II error</strong>.</p>
<p>We can summarize the predictions of a classification model in a <strong>confusion matrix</strong> as seen in <a href="#fig-confusion-matrix" class="quarto-xref">Figure&nbsp;<span>2.7</span></a>. The confusion matrix is a <span class="math inline">\(2\times 2\)</span> matrix that shows the number of true positives (TP), true negatives (TN), false positives (FP), and false negatives (FN) of a binary classification model.</p>
<div id="fig-confusion-matrix" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-confusion-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="basics_files/figure-html/confusion-matrix-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-confusion-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.7: Confusion matrix
</figcaption>
</figure>
</div>
<p>There is a <strong>tradeoff</strong> between the two types of errors. For example, you <em>could get fewer false negatives by predicting <span class="math inline">\(\hat{y}=1\)</span> more often, but this would increase the number of false positives</em>. In the extreme case, if you only predict <span class="math inline">\(\hat{y}=1\)</span> for all observations, you would have no false negatives at all. However, you would also have no true negatives making the model of questionable usefulness.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Confusion Matrix: Dependence on Classification Threshold <span class="math inline">\(t\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>The number of true positives, true negatives, false positives, and false negatives in the confusion matrix depends on the classification threshold <span class="math inline">\(t\)</span>.</p>
</div>
</div>
<p>Note that we can compute the <strong>accuracy</strong> measure as a function of true positives (TP), true negatives (TN), false positives (FP) and false negatives (FN) <span class="math display">\[\text{Accuracy} = \frac{\text{TP}+\text{TN}}{\text{TP}+\text{TN}+\text{FP}+\text{FN}},\]</span></p>
<p>while the <strong>missclassification rate</strong> is given by <span class="math display">\[\text{Missclassification Rate} = \frac{\text{FP}+\text{FN}}{\text{TP}+\text{TN}+\text{FP}+\text{FN}}.\]</span></p>
<p>Another useful measure that can be derived from the confusion matrix is the <strong>precision</strong>. It measures the fraction of positive predictions that were actually correct, i.e., <span class="math display">\[\text{Precision} = \frac{\text{TP}}{\text{TP}+\text{FP}}\]</span></p>
<p>The <strong>true positive rate (TPR)</strong> or <strong>recall</strong> or <strong>sensitivity</strong> measures the fraction of actual positives that were correctly predicted, i.e. <span class="math display">\[\text{Recall} = \frac{\text{TP}}{\text{TP}+\text{FN}}.\]</span></p>
<p>Analogously, <strong>true negative rate (TNR)</strong> or <strong>specificity</strong> measures the fraction of actual negatives that were correctly predicted, i.e., <span class="math display">\[\text{TNR} = \frac{\text{TN}}{\text{FP}+\text{TN}}\]</span></p>
<p>Finally, the <strong>false positive rate (FPR)</strong> measures the fraction of actual negatives that were incorrectly predicted to be positive, i.e., <span class="math display">\[\text{FPR} = 1-\text{TNR} = \frac{\text{FP}}{\text{FP}+\text{TN}}\]</span></p>
<p>Note that all of these measures can be computed for a given classification threshold <span class="math inline">\(t\)</span>. They capture different aspects of the quality of the predictions of a classification model.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Multiclass Classification
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the case of multiclass classification, the confusion matrix is a <span class="math inline">\(K\times K\)</span> matrix, where <span class="math inline">\(K\)</span> is the number of classes. The diagonal elements of the confusion matrix represent the number of correct predictions for each class, while the off-diagonal elements represent the number of incorrect predictions.</p>
<p>Note that we can binarize multiclass classification problems, which allows us to use the same metrics as in binary classification. Two such binarization schemes are</p>
<ul>
<li><strong>One-vs-Rest</strong> (or <strong>One-vs-All</strong>): In this scheme, we train <span class="math inline">\(K\)</span> binary classifiers, one for each class to distinguish it from all other classes. We can then use the class with the highest score as the predicted class for a new observation.</li>
<li><strong>One-vs-One</strong>: In this scheme, we train <span class="math inline">\(K(K-1)/2\)</span> binary classifiers, one for each pair of classes. We can then use a majority vote to determine the class of a new observation.</li>
</ul>
</div>
</div>
</section>
<section id="receiver-operating-characteristic-roc-curves-and-area-under-the-curve-auc" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="receiver-operating-characteristic-roc-curves-and-area-under-the-curve-auc">Receiver Operating Characteristic (ROC) Curves and Area Under the Curve (AUC)</h4>
<p><a href="#fig-roc" class="quarto-xref">Figure&nbsp;<span>2.8</span></a> shows a <strong>Receiver Operating Characteristic (ROC) curve</strong> which is a graphical representation of the tradeoff between the true positive rate (TPR) and the false positive rate (FPR) for different classification thresholds. The ROC curve is a useful tool to visualize the performance of a classification model. The diagonal line in the ROC curve represents a random classifier. A classifier that is better than random will have a ROC curve above the diagonal line. The closer the ROC curve is to the top-left corner, the better the classifier.</p>
<div id="fig-roc" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-roc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="basics_files/figure-html/roc-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-roc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.8: Receiver Operating Characteristic (ROC) Curve
</figcaption>
</figure>
</div>
<p>The <strong>Area Under the Curve (AUC)</strong> of the ROC curve is a measure to compare different classification models. The AUC is a value between 0 and 1, where a value of 1 indicates a perfect classifier and a value of 0.5 indicates a random classifier. <a href="#fig-auc" class="quarto-xref">Figure&nbsp;<span>2.9</span></a> shows the AUC of a classifier as the shaded area under the ROC curve. Note that the AUC summarizes the ROC curve, which itself represents the quality of predictions of our classification model at different thresholds, in a single number.</p>
<div id="fig-auc" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-auc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="basics_files/figure-html/auc-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-auc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.9: Area Under the Curve (AUC)
</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="generalization-and-overfitting" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="generalization-and-overfitting"><span class="header-section-number">2.4</span> Generalization and Overfitting</h2>
<p>Typically, we are not just interested in having a good fit for the dataset on which we are training a classification (or regression) model, after all, we already have the actual classes or realization of predicted variables in our dataset. What <strong>we are really interested in is that a classification or regression model generalizes to new data</strong>.</p>
<p>However, since the models that we are using are highly flexible, it can be the case that we have a very high accuracy during the training of our model but it does not provide good predictions when used on new data. This situation is called <strong>overfitting</strong>: we have a very good fit in our training dataset, but predictions for new data inputs are bad.</p>
<div id="fig-overfitting-underfitting" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-overfitting-underfitting-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="3" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="basics_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="basics_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="basics_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-overfitting-underfitting-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.10: Examples of Overfitting and Underfitting
</figcaption>
</figure>
</div>
<p><a href="#fig-overfitting-underfitting" class="quarto-xref">Figure&nbsp;<span>2.10</span></a> provides examples of overfitting and underfitting. The blue dots represent the training data <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, the orange curve represents the fit of the model to the training data. The left plot shows an example of <strong>underfitting</strong>: the model is too simple to capture the underlying structure of the data. The middle plot shows a â€œgood fitâ€: the model captures the underlying structure of the data. The right plot shows an example of <strong>overfitting</strong>: the model is too complex and captures the noise in the data.</p>
<section id="bias-variance-tradeoff" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="bias-variance-tradeoff"><span class="header-section-number">2.4.1</span> Bias-Variance Tradeoff</h3>
<p>The concepts of <strong>bias</strong> and <strong>variance</strong> are useful to understand the tradeoff between underfitting and overfitting. Suppose that data is generated from the true model <span class="math inline">\(Y=f(X)+\epsilon\)</span>, where <span class="math inline">\(\epsilon\)</span> is a random error term such that <span class="math inline">\(\mathbb{E}[\epsilon]=0\)</span> and <span class="math inline">\(\text{Var}[\epsilon]=\sigma^2\)</span>. Let <span class="math inline">\(\hat{f}(x)\)</span> be the prediction of the model at <span class="math inline">\(x\)</span>. One can show that the expected prediction error (or generalization error) of a model can be decomposed into three parts</p>
<p><span class="math display">\[\text{EPE}(x_0) = \mathbb{E}[(Y-\hat{f}(x_0))^2|X=x_0] = \text{Bias}^2(\hat{f}(x_0)) + \text{Var}(\hat{f}(x_0)) + \sigma^2,\]</span></p>
<p>where <span class="math inline">\(\text{Bias}(\hat{f}(x_0)) = \mathbb{E}[\hat{f}(x_0)]-f(x_0)\)</span> is the bias at <span class="math inline">\(x_0\)</span>, <span class="math inline">\(\text{Var}(\hat{f}(x_0)) = \mathbb{E}[\hat{f}(x_0)^2]-\mathbb{E}[\hat{f}(x_0)]^2\)</span> is the variance at <span class="math inline">\(x_0\)</span>, and <span class="math inline">\(\sigma^2\)</span> is the irreducible error, i.e., the error that cannot be reduced by any model. As model complexity increases, the bias tends to decrease, but the variance tends to increase. The following quote from <a href="https://www.cs.cornell.edu/courses/cs4780/2018fa/lectures/lecturenote12.html">Cornell lecture notes</a> summarizes the bias-variance tradeoff well:</p>
<blockquote class="blockquote">
<p>Variance: Captures how much your classifier changes if you train on a different training set. How â€œover-specializedâ€ is your classifier to a particular training set (overfitting)? If we have the best possible model for our training data, how far off are we from the average classifier?</p>
<p>Bias: What is the inherent error that you obtain from your classifier even with infinite training data? This is due to your classifier being â€œbiasedâ€ to a particular kind of solution (e.g.&nbsp;linear classifier). In other words, bias is inherent to your model.</p>
<p>Noise: How big is the data-intrinsic noise? This error measures ambiguity due to your data distribution and feature representation. You can never beat this, it is an aspect of the data.</p>
</blockquote>
<div id="fig-generalization-error" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-generalization-error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="basics_files/figure-html/generalization-error-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-generalization-error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.11: Model Complexity and Generalization Error <span class="citation" data-cites="Hastie2009">(adapted from <a href="references.html#ref-Hastie2009" role="doc-biblioref">Hastie, Tibshirani, and Friedman 2009</a>)</span>
</figcaption>
</figure>
</div>
<p><a href="#fig-generalization-error" class="quarto-xref">Figure&nbsp;<span>2.11</span></a> shows the relationship between the model complexity and the prediction error. A more complex model can reduce the prediction error only up to a certain point. After this point, the model starts to overfit the training data (it learns noise in the data), and the prediction error for the test data (i.e., data not used for model training) increases. Ideally, we would like to find the model complexity that minimizes the prediction error for the test data.</p>
</section>
<section id="regularization" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="regularization"><span class="header-section-number">2.4.2</span> Regularization</h3>
<p>One approach to avoid overfitting is to use <strong>regularization</strong>. Regularization adds a penalty term to the loss function that penalizes large weights. The most common regularization techniques are <strong>L1 regularization</strong> and <strong>L2 regularization</strong>. L1 regularization adds the sum of the absolute values of the weights to the loss function, while L2 regularization adds the sum of the squared weights to the loss function.</p>
<p>These techniques are applicable across a large range of ML models and depending on the type of model additional regularization techniques might be available. For example, in neural networks, <strong>dropout regularization</strong> is a common regularization technique that randomly removes a set of artificial neurons during training.</p>
<p>In the context of linear regressions, L1 regularization is also called <strong>LASSO regression</strong>. The loss function of LASSO regression is given by</p>
<p><span class="math display">\[\text{Loss} = \text{MSE}(y,x; w) + \lambda \sum_{i=1}^m |w_i|,\]</span></p>
<p>where <span class="math inline">\(\text{MSE}(y,x; w)\)</span> refers to the mean squared error (the standard loss function of a linear regression), <span class="math inline">\(\lambda\)</span> is a hyperparameter that controls the strength of the regularization. Note that LASSO regression can also be used for <strong>feature selection</strong>, as it tends to set the weights of irrelevant features to zero. <a href="#fig-lasso-regression-loss" class="quarto-xref">Figure&nbsp;<span>2.12</span></a> shows the LASSO regression loss for different levels of <span class="math inline">\(\lambda\)</span>.</p>
<div id="fig-lasso-regression-loss" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lasso-regression-loss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="basics_files/figure-html/unnamed-chunk-10-7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lasso-regression-loss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.12: LASSO Regression Loss for Different Levels of <span class="math inline">\(\lambda\)</span>
</figcaption>
</figure>
</div>
<p>An L2 regularization in a linear regression context is called a <strong>Ridge regression</strong>. Its loss function is given by</p>
<p><span class="math display">\[\text{Loss} = \text{MSE}(y,x; w) + \lambda \sum_{i=1}^m w_i^2.\]</span></p>
<p>We will have a closer look at regularization in the application sections. For now, it is important to understand that regularization works by constraining the weights of the model (i.e., keeping the weights small), which can help to avoid overfitting (which might require some weights to be very large). <a href="#fig-ridge-regression-loss" class="quarto-xref">Figure&nbsp;<span>2.13</span></a> shows the Ridge regression loss for different levels of <span class="math inline">\(\lambda\)</span>. Note how the Ridge regression loss is smoother than the LASSO regression loss and that the weights are never set to exactly zero but just get closer and closer to zero.</p>
<div id="fig-ridge-regression-loss" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ridge-regression-loss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="basics_files/figure-html/unnamed-chunk-11-9.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ridge-regression-loss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.13: Ridge Regression Loss for Different Levels of <span class="math inline">\(\lambda\)</span>
</figcaption>
</figure>
</div>
</section>
<section id="training-validation-and-test-datasets" class="level3" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="training-validation-and-test-datasets"><span class="header-section-number">2.4.3</span> Training, Validation, and Test Datasets</h3>
<p>Regularization discussed in the previous section is a method to directly <em>prevent</em> overfitting. However, another approach to the issues is to <strong>adjust our evaluation procedure</strong> in a way that allows us <em>to detect overfitting</em>. To do this, we can split the dataset into several parts. The first option shown in <a href="#fig-training-test-dataset" class="quarto-xref">Figure&nbsp;<span>2.14</span></a> is to split the dataset into a <strong>training dataset</strong> and a <strong>test dataset</strong>. The training dataset is used to train the model, while the test dataset is used to evaluate the model. Why does this help to detect overfitting? If the model performs well on the training dataset but poorly on the test dataset, this is a sign of overfitting. If the model performs well on the test dataset, this is a sign that the model generalizes well to new data.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difference with Terminology in Econometrics/Statistics
</div>
</div>
<div class="callout-body-container callout-body">
<p>In econometrics/statistics, it is more common to talk about <strong>in-sample</strong> and <strong>out-of-sample</strong> performance. The idea is the same: the in-sample performance is the performance of the model on the training dataset, while the out-of-sample performance is the performance of the model on the test dataset.</p>
</div>
</div>
<div id="fig-training-test-dataset" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-training-test-dataset-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="basics_files/figure-html/training-test-dataset-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-training-test-dataset-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.14: Option A - Splitting the Whole Dataset into Training, and Test Datasets
</figcaption>
</figure>
</div>
<p>The second option shown in <a href="#fig-training-test-validation-dataset" class="quarto-xref">Figure&nbsp;<span>2.15</span></a> is to split the dataset into a <strong>training dataset</strong>, a <strong>validation dataset</strong>, and a <strong>test dataset</strong>. The training dataset is used to train the model, the validation dataset is used to tune the hyperparameters of the model, and the test dataset is used to evaluate the model.</p>
<div id="fig-training-test-validation-dataset" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-training-test-validation-dataset-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="basics_files/figure-html/training-test-validation-dataset-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-training-test-validation-dataset-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.15: Option B - Splitting the Whole Dataset into Training, Test, and Validation Datasets
</figcaption>
</figure>
</div>
<p>Common splits are 75% training and 30% test, or 80% training and 20% test in Option A. In Option B, a common split is 70% training, 15% validation, and 15% test.</p>
</section>
<section id="cross-validation" class="level3" data-number="2.4.4">
<h3 data-number="2.4.4" class="anchored" data-anchor-id="cross-validation"><span class="header-section-number">2.4.4</span> Cross-Validation</h3>
<p>Another approach to detect overfitting is to use <strong>cross-validation</strong>. There are different types of cross-validation but <strong>k-fold cross-validation</strong> is probably the most common. In k-fold cross-validation, shown in <a href="#fig-cross-validation" class="quarto-xref">Figure&nbsp;<span>2.16</span></a>, the dataset is split into <span class="math inline">\(k\)</span> parts (called <strong>folds</strong>). The model is trained on <span class="math inline">\(k-1\)</span> folds and evaluated on the remaining fold. This process is repeated <span class="math inline">\(k\)</span> times, each time using a different fold as the test fold. The performance of the model is then averaged over the <span class="math inline">\(k\)</span> iterations. In practice, <span class="math inline">\(k=10\)</span> is a common choice. If we set <span class="math inline">\(k=N\)</span>, where <span class="math inline">\(N\)</span> is the number of observations in the dataset, we call this <strong>leave-one-out cross-validation</strong> or <strong>LOOCV</strong>.</p>
<div id="fig-cross-validation" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cross-validation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="basics_files/figure-html/cross-validation-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cross-validation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.16: 5-Fold Cross-Validation
</figcaption>
</figure>
</div>
<p>The advantage of cross-validation is that it allows us to use all the data for training and testing. The disadvantage is that it is computationally more expensive than a simple training-test split.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mini-Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Implement a 5-fold cross-validation for the logistic regression model in the Python example below. Use the <code>cross_val_score</code> function from the <code>sklearn.model_selection</code> module.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the cross_val_score function</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply 5-fold cross-validation to the classifier clf</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>cv_scores <span class="op">=</span> cross_val_score(clf, X, y, cv<span class="op">=</span><span class="dv">5</span>, scoring<span class="op">=</span><span class="st">'roc_auc'</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean of the cross-validation scores</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>cv_scores.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
</section>
<section id="python-implementation" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="python-implementation"><span class="header-section-number">2.5</span> Python Implementation</h2>
<div class="quarto-embed-nb-cell" data-notebook="/Users/joel/Dropbox (Privat)/Studium/CEMFI/PhD/TA/Data Science for Diploma in Banking Supervision/Local/Lecture Notes/notebooks/basic_concepts.ipynb" data-notebook-title="Check if the file exists" data-notebook-cellid="cell-0">
<p>Letâ€™s have a look at how to implement a logistic regression model in Python. First, we need to import the required packages</p>
<div id="cell-1" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:49.003514Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:49.003210Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:51.001946Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:51.001272Z&quot;}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, MinMaxScaler</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, accuracy_score, roc_auc_score, recall_score, precision_score, roc_curve</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="dv">50</span>) <span class="co"># Display up to 50 columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Letâ€™s download the dataset automatically, unzip it, and place it in a folder called <code>data</code> if you havenâ€™t done so already</p>
<div id="cell-3" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:51.006153Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:51.005740Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:51.011023Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:51.010268Z&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> BytesIO</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> urllib.request <span class="im">import</span> urlopen</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> zipfile <span class="im">import</span> ZipFile</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os.path</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the file exists</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.isfile(<span class="st">'data/card_transdata.csv'</span>):</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Downloading dataset...'</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the dataset to be downloaded</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    zipurl <span class="op">=</span> <span class="st">'https://www.kaggle.com/api/v1/datasets/download/dhanushnarayananr/credit-card-fraud'</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Download and unzip the dataset in the data folder</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> urlopen(zipurl) <span class="im">as</span> zipresp:</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> ZipFile(BytesIO(zipresp.read())) <span class="im">as</span> zfile:</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>            zfile.extractall(<span class="st">'data'</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Dataset already downloaded!'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dataset already downloaded!</code></pre>
</div>
</div>
<p>Then, we can load the data into a DataFrame using the <code>read_csv</code> function from the <code>pandas</code> library</p>
<div id="cell-5" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:51.044598Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:51.044304Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:51.864553Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:51.863948Z&quot;}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/card_transdata.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that it is common to call this variable <code>df</code> which is short for DataFrame.</p>
<p>This is a <strong>dataset of credit card transactions</strong> from <a href="https://www.kaggle.com/datasets/dhanushnarayananr/credit-card-fraud/data">Kaggle.com</a>. The target variable <span class="math inline">\(y\)</span> is <code>fraud</code>, which indicates whether the transaction is fraudulent or not. The other variables are the features <span class="math inline">\(x\)</span> of the transactions.</p>
<section id="data-exploration-preprocessing" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="data-exploration-preprocessing"><span class="header-section-number">2.5.1</span> Data Exploration &amp; Preprocessing</h3>
<p>The first step whenever you load a new dataset is to familiarize yourself with it. You need to understand what the variables represent, what the target variable is, and what the data looks like. This is called <strong>data exploration</strong>. Depending on the dataset, you might need to preprocess it (e.g., check for missing values and duplicates, or create new variables) before you can use it to train a machine-learning model. This is called <strong>data preprocessing</strong>.</p>
<section id="basic-dataframe-operations" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="basic-dataframe-operations">Basic Dataframe Operations</h4>
<p>Letâ€™s see how many rows and columns the dataset has</p>
<div id="cell-7" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:51.867890Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:51.867645Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:51.874418Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:51.873736Z&quot;}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>(1000000, 8)</code></pre>
</div>
</div>
<p>The dataset has 1 million rows (observations) and 8 columns (variables)! Now, letâ€™s have a look at the first few rows of the dataset with the <code>head()</code> method</p>
<div id="cell-9" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:51.877191Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:51.876986Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:51.887113Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:51.886610Z&quot;}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df.head().T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">distance_from_home</td>
<td>57.877857</td>
<td>10.829943</td>
<td>5.091079</td>
<td>2.247564</td>
<td>44.190936</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">distance_from_last_transaction</td>
<td>0.311140</td>
<td>0.175592</td>
<td>0.805153</td>
<td>5.600044</td>
<td>0.566486</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ratio_to_median_purchase_price</td>
<td>1.945940</td>
<td>1.294219</td>
<td>0.427715</td>
<td>0.362663</td>
<td>2.222767</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">repeat_retailer</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">used_chip</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">used_pin_number</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">online_order</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">fraud</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>If you would like to see more entries in the dataset, you can use the <code>head()</code> method with an argument corresponding to the number of rows, e.g.,</p>
<div id="cell-11" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:51.890040Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:51.889825Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:51.904179Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:51.903589Z&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">ratio_to_median_purchase_price</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
<th data-quarto-table-cell-role="th">fraud</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>57.877857</td>
<td>0.311140</td>
<td>1.945940</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10.829943</td>
<td>0.175592</td>
<td>1.294219</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.091079</td>
<td>0.805153</td>
<td>0.427715</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.247564</td>
<td>5.600044</td>
<td>0.362663</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>44.190936</td>
<td>0.566486</td>
<td>2.222767</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>5.586408</td>
<td>13.261073</td>
<td>0.064768</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>3.724019</td>
<td>0.956838</td>
<td>0.278465</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>4.848247</td>
<td>0.320735</td>
<td>1.273050</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>0.876632</td>
<td>2.503609</td>
<td>1.516999</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>8.839047</td>
<td>2.970512</td>
<td>2.361683</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>14.263530</td>
<td>0.158758</td>
<td>1.136102</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>13.592368</td>
<td>0.240540</td>
<td>1.370330</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>765.282559</td>
<td>0.371562</td>
<td>0.551245</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>2.131956</td>
<td>56.372401</td>
<td>6.358667</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>13.955972</td>
<td>0.271522</td>
<td>2.798901</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>179.665148</td>
<td>0.120920</td>
<td>0.535640</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>114.519789</td>
<td>0.707003</td>
<td>0.516990</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>3.589649</td>
<td>6.247458</td>
<td>1.846451</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>11.085152</td>
<td>34.661351</td>
<td>2.530758</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>6.194671</td>
<td>1.142014</td>
<td>0.307217</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Note that analogously you can also use the <code>tail()</code> method to see the last few rows of the dataset.</p>
<p>We can also check what the variables in our dataset are called</p>
<div id="cell-13" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:51.907678Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:51.907467Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:51.911247Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:51.910741Z&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>Index(['distance_from_home', 'distance_from_last_transaction',
       'ratio_to_median_purchase_price', 'repeat_retailer', 'used_chip',
       'used_pin_number', 'online_order', 'fraud'],
      dtype='object')</code></pre>
</div>
</div>
<p>and the data types of the variables</p>
<div id="cell-15" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:51.913931Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:51.913662Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:51.919780Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:51.919186Z&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>distance_from_home                float64
distance_from_last_transaction    float64
ratio_to_median_purchase_price    float64
repeat_retailer                   float64
used_chip                         float64
used_pin_number                   float64
online_order                      float64
fraud                             float64
dtype: object</code></pre>
</div>
</div>
<p>In this case, all our variables are floating-point numbers (<code>float</code>). This means that they are numbers that have a fractional part such as 1.5, 3.14, etc. The number after <code>float</code>, <code>64</code> in this case refers to the number of bits that are used to represent this number in the computerâ€™s memory. With 64 bits you can store more decimals than you could with, for example, 32, meaning that the results of computations can be more precise. But for the topics discussed in this course, this is not very important. Other common data types that you might encounter are integers (<code>int</code>) such as 1, 3, 5, etc., or strings (<code>str</code>) such as <code>'hello'</code>, <code>'world'</code>, etc.</p>
<p>Letâ€™s dig deeper into the dataset and see some summary statistics</p>
<div id="cell-17" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:51.922759Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:51.922536Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:52.181322Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:52.180743Z&quot;}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df.describe().T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">distance_from_home</td>
<td>1000000.0</td>
<td>26.628792</td>
<td>65.390784</td>
<td>0.004874</td>
<td>3.878008</td>
<td>9.967760</td>
<td>25.743985</td>
<td>10632.723672</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">distance_from_last_transaction</td>
<td>1000000.0</td>
<td>5.036519</td>
<td>25.843093</td>
<td>0.000118</td>
<td>0.296671</td>
<td>0.998650</td>
<td>3.355748</td>
<td>11851.104565</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ratio_to_median_purchase_price</td>
<td>1000000.0</td>
<td>1.824182</td>
<td>2.799589</td>
<td>0.004399</td>
<td>0.475673</td>
<td>0.997717</td>
<td>2.096370</td>
<td>267.802942</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">repeat_retailer</td>
<td>1000000.0</td>
<td>0.881536</td>
<td>0.323157</td>
<td>0.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">used_chip</td>
<td>1000000.0</td>
<td>0.350399</td>
<td>0.477095</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">used_pin_number</td>
<td>1000000.0</td>
<td>0.100608</td>
<td>0.300809</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">online_order</td>
<td>1000000.0</td>
<td>0.650552</td>
<td>0.476796</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">fraud</td>
<td>1000000.0</td>
<td>0.087403</td>
<td>0.282425</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>With the <code>describe()</code> method we can see the count, mean, standard deviation, minimum, 25th percentile, median, 75th percentile, and maximum values of each variable in the dataset.</p>
</section>
<section id="checking-for-missing-values-and-duplicated-rows" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="checking-for-missing-values-and-duplicated-rows">Checking for Missing Values and Duplicated Rows</h4>
<p>It is also important to check for missing values and duplicated rows in the dataset. Missing values can be problematic for machine learning models, as they might not be able to handle them. Duplicated rows can also be problematic, as they might introduce bias in the model.</p>
<p>We can check for missing values (NA) that are encoded as None or <code>numpy.NaN</code> (Not a Number) with the <code>isna()</code> method. This method returns a boolean DataFrame (i.e., a DataFrame with <code>True</code> and <code>False</code> values) with the same shape as the original DataFrame, where <code>True</code> values indicate missing values.</p>
<div id="cell-19" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:52.184374Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:52.184080Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:52.199005Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:52.198388Z&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df.isna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">ratio_to_median_purchase_price</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
<th data-quarto-table-cell-role="th">fraud</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999995</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">999996</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999997</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">999998</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999999</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>1000000 rows Ã— 8 columns</p>
</div>
</div>
</div>
</div>
<p>or to make it easier to see, we can sum the number of missing values for each variable</p>
<div id="cell-21" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:52.202287Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:52.202043Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:52.215942Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:52.215396Z&quot;}" data-execution_count="11">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>distance_from_home                0
distance_from_last_transaction    0
ratio_to_median_purchase_price    0
repeat_retailer                   0
used_chip                         0
used_pin_number                   0
online_order                      0
fraud                             0
dtype: int64</code></pre>
</div>
</div>
<p>Luckily, there seem to be no missing values. However, you need to be careful! Sometimes missing values are encoded as empty strings <code>''</code> or <code>numpy.inf</code> (infinity), which are not considered missing values by the <code>isna()</code> method. If you suspect that this might be the case, you need to make additional checks.</p>
<p>As an alternative, we could also look at the <code>info()</code> method, which provides a summary of the DataFrame, including the number of non-null values in each column. If there are missing values, the number of non-null values will be less than the number of rows in the dataset.</p>
<div id="cell-23" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:52.219081Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:52.218816Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:52.236480Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:52.235866Z&quot;}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1000000 entries, 0 to 999999
Data columns (total 8 columns):
 #   Column                          Non-Null Count    Dtype  
---  ------                          --------------    -----  
 0   distance_from_home              1000000 non-null  float64
 1   distance_from_last_transaction  1000000 non-null  float64
 2   ratio_to_median_purchase_price  1000000 non-null  float64
 3   repeat_retailer                 1000000 non-null  float64
 4   used_chip                       1000000 non-null  float64
 5   used_pin_number                 1000000 non-null  float64
 6   online_order                    1000000 non-null  float64
 7   fraud                           1000000 non-null  float64
dtypes: float64(8)
memory usage: 61.0 MB</code></pre>
</div>
</div>
<p>We can also check for duplicated rows with the <code>duplicated()</code> method.</p>
<div id="cell-25" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:52.239589Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:52.239339Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:52.587659Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:52.587046Z&quot;}" data-execution_count="13">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df.loc[df.duplicated()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">ratio_to_median_purchase_price</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
<th data-quarto-table-cell-role="th">fraud</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Luckily, there are also no duplicated rows.</p>
</section>
<section id="data-visualization" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="data-visualization">Data Visualization</h4>
<p>Letâ€™s continue with some data visualization. We can use the <code>matplotlib</code> library to create plots. We have already imported the library at the beginning of the notebook.</p>
<p>Letâ€™s start by plotting the distribution of the target variable <code>fraud</code> which can only take values zero and one. We can type</p>
<div id="cell-27" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:52.590790Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:52.590512Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:52.603791Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:52.603157Z&quot;}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'fraud'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>fraud
0.0    912597
1.0     87403
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>to get the count of each value. We can also use the <code>normalize=True</code> argument to get the fraction of observations instead of the count</p>
<div id="cell-29" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:52.607007Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:52.606742Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:52.618701Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:52.618152Z&quot;}" data-execution_count="15">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'fraud'</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>fraud
0.0    0.912597
1.0    0.087403
Name: proportion, dtype: float64</code></pre>
</div>
</div>
<p>We can then plot it as follows</p>
<div id="cell-31" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:52.621627Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:52.621392Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:52.802390Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:52.801742Z&quot;}" data-execution_count="16">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'fraud'</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Fraud'</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Fraction of Observations'</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Fraud'</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.gca()</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>ax.set_ylim([<span class="fl">0.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="basics_files/figure-html/notebooks-basic_concepts-cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Alternatively, we can plot it as a pie chart</p>
<div id="cell-33" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:52.805338Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:52.805116Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:52.888568Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:52.887700Z&quot;}" data-execution_count="17">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df.value_counts(<span class="st">"fraud"</span>).plot.pie(autopct <span class="op">=</span> <span class="st">"</span><span class="sc">%.1f</span><span class="st">"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">''</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="basics_files/figure-html/notebooks-basic_concepts-cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Our dataset seems to be quite imbalanced, as only 8.7% of the transactions are fraudulent. This is a common problem in fraud detection datasets, as fraudulent transactions are usually very rare. We will need to <strong>keep this in mind</strong> when evaluating our machine learning model: the accuracy measure will be very high even for bad models, as the model can just predict that all transactions are not fraudulent and still get an accuracy of 91.3%.</p>
<p>Letâ€™s look at some distributions. Most of the variables in the dataset are binary (0 or 1) variables. However, we also have some continuous variables. Letâ€™s plot the distribution of the variable <code>ratio_to_median_purchase_price</code>, which is a continuous variable.</p>
<div id="cell-35" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:52.892250Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:52.892020Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:53.102372Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:53.101866Z&quot;}" data-execution_count="18">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'ratio_to_median_purchase_price'</span>].hist(bins <span class="op">=</span> <span class="dv">50</span>, <span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="dv">30</span>])</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Ratio to Median Purchase Price'</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Count'</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="basics_files/figure-html/notebooks-basic_concepts-cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can also plot the distribution of the variable <code>ratio_to_median_purchase_price</code> by the target variable <code>fraud</code> to see if there are any differences between fraudulent and non-fraudulent transactions</p>
<div id="cell-37" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:53.105151Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:53.104928Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:53.540426Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:53.539861Z&quot;}" data-execution_count="19">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'ratio_to_median_purchase_price'</span>].hist(bins <span class="op">=</span> <span class="dv">50</span>, <span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="dv">30</span>], by<span class="op">=</span>df[<span class="st">'fraud'</span>], ax <span class="op">=</span> ax)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'Ratio to Median Purchase Price'</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'Ratio to Median Purchase Price'</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'No Fraud'</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Fraud'</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="basics_files/figure-html/notebooks-basic_concepts-cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>There are indeed some differences between fraudulent and non-fraudulent transactions. For example, fraudulent transactions seem to have a higher ratio to the median purchase price, which is expected as fraudsters might try to make large transactions to maximize their profit.</p>
<p>We can also look at the correlation between the variables in the dataset. The correlation is a measure of how two variables move together</p>
<div id="cell-39" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:53.543158Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:53.542869Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:53.721490Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:53.720924Z&quot;}" data-execution_count="20">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df.corr() <span class="co"># Pearson correlation (for linear relationships)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">ratio_to_median_purchase_price</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
<th data-quarto-table-cell-role="th">fraud</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">distance_from_home</td>
<td>1.000000</td>
<td>0.000193</td>
<td>-0.001374</td>
<td>0.143124</td>
<td>-0.000697</td>
<td>-0.001622</td>
<td>-0.001301</td>
<td>0.187571</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">distance_from_last_transaction</td>
<td>0.000193</td>
<td>1.000000</td>
<td>0.001013</td>
<td>-0.000928</td>
<td>0.002055</td>
<td>-0.000899</td>
<td>0.000141</td>
<td>0.091917</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ratio_to_median_purchase_price</td>
<td>-0.001374</td>
<td>0.001013</td>
<td>1.000000</td>
<td>0.001374</td>
<td>0.000587</td>
<td>0.000942</td>
<td>-0.000330</td>
<td>0.462305</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">repeat_retailer</td>
<td>0.143124</td>
<td>-0.000928</td>
<td>0.001374</td>
<td>1.000000</td>
<td>-0.001345</td>
<td>-0.000417</td>
<td>-0.000532</td>
<td>-0.001357</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">used_chip</td>
<td>-0.000697</td>
<td>0.002055</td>
<td>0.000587</td>
<td>-0.001345</td>
<td>1.000000</td>
<td>-0.001393</td>
<td>-0.000219</td>
<td>-0.060975</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">used_pin_number</td>
<td>-0.001622</td>
<td>-0.000899</td>
<td>0.000942</td>
<td>-0.000417</td>
<td>-0.001393</td>
<td>1.000000</td>
<td>-0.000291</td>
<td>-0.100293</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">online_order</td>
<td>-0.001301</td>
<td>0.000141</td>
<td>-0.000330</td>
<td>-0.000532</td>
<td>-0.000219</td>
<td>-0.000291</td>
<td>1.000000</td>
<td>0.191973</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">fraud</td>
<td>0.187571</td>
<td>0.091917</td>
<td>0.462305</td>
<td>-0.001357</td>
<td>-0.060975</td>
<td>-0.100293</td>
<td>0.191973</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-40" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:53.724604Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:53.724355Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:54.676268Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:54.675399Z&quot;}" data-execution_count="21">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df.corr(<span class="st">'spearman'</span>) <span class="co"># Spearman correlation (for monotonic relationships)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">distance_from_home</th>
<th data-quarto-table-cell-role="th">distance_from_last_transaction</th>
<th data-quarto-table-cell-role="th">ratio_to_median_purchase_price</th>
<th data-quarto-table-cell-role="th">repeat_retailer</th>
<th data-quarto-table-cell-role="th">used_chip</th>
<th data-quarto-table-cell-role="th">used_pin_number</th>
<th data-quarto-table-cell-role="th">online_order</th>
<th data-quarto-table-cell-role="th">fraud</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">distance_from_home</td>
<td>1.000000</td>
<td>-0.001068</td>
<td>-0.000152</td>
<td>0.559724</td>
<td>-0.000118</td>
<td>-0.000338</td>
<td>-0.001812</td>
<td>0.095032</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">distance_from_last_transaction</td>
<td>-0.001068</td>
<td>1.000000</td>
<td>-0.000111</td>
<td>-0.001352</td>
<td>-0.000165</td>
<td>0.000555</td>
<td>-0.001076</td>
<td>0.034661</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ratio_to_median_purchase_price</td>
<td>-0.000152</td>
<td>-0.000111</td>
<td>1.000000</td>
<td>0.001202</td>
<td>-0.000099</td>
<td>0.000251</td>
<td>-0.000376</td>
<td>0.342838</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">repeat_retailer</td>
<td>0.559724</td>
<td>-0.001352</td>
<td>0.001202</td>
<td>1.000000</td>
<td>-0.001345</td>
<td>-0.000417</td>
<td>-0.000532</td>
<td>-0.001357</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">used_chip</td>
<td>-0.000118</td>
<td>-0.000165</td>
<td>-0.000099</td>
<td>-0.001345</td>
<td>1.000000</td>
<td>-0.001393</td>
<td>-0.000219</td>
<td>-0.060975</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">used_pin_number</td>
<td>-0.000338</td>
<td>0.000555</td>
<td>0.000251</td>
<td>-0.000417</td>
<td>-0.001393</td>
<td>1.000000</td>
<td>-0.000291</td>
<td>-0.100293</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">online_order</td>
<td>-0.001812</td>
<td>-0.001076</td>
<td>-0.000376</td>
<td>-0.000532</td>
<td>-0.000219</td>
<td>-0.000291</td>
<td>1.000000</td>
<td>0.191973</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">fraud</td>
<td>0.095032</td>
<td>0.034661</td>
<td>0.342838</td>
<td>-0.001357</td>
<td>-0.060975</td>
<td>-0.100293</td>
<td>0.191973</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>This is still a bit hard to read. We can visualize the correlation matrix with a heatmap using the Seaborn library, which we have already imported at the beginning of the notebook.</p>
<div id="cell-42" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:54.679891Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:54.679595Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:55.822967Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:55.822426Z&quot;}" data-execution_count="22">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> df.corr(<span class="st">'spearman'</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> sns.diverging_palette(<span class="dv">10</span>, <span class="dv">255</span>, as_cmap<span class="op">=</span><span class="va">True</span>) <span class="co"># Create a color map</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.triu(np.ones_like(corr, dtype<span class="op">=</span><span class="bu">bool</span>)) <span class="co"># Create a mask to only show the lower triangle of the matrix</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr, cmap<span class="op">=</span>cmap, vmax<span class="op">=</span><span class="dv">1</span>, center<span class="op">=</span><span class="dv">0</span>, mask<span class="op">=</span>mask) <span class="co"># Create a heatmap of the correlation matrix (Note: vmax=1 makes sure that the color map goes up to 1 and center=0 are used to center the color map at 0)</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="basics_files/figure-html/notebooks-basic_concepts-cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Note how <code>ratio_to_median_purchase_price</code> is positively correlated with <code>fraud</code>, which is expected as we saw in the previous plot that fraudulent transactions have a higher ratio to the median purchase price. Furthermore, <code>used_chip</code> and <code>used_pin_number</code> are negatively correlated with <code>fraud</code>, which makes sense as transactions, where the chip or the pin is used, are supposed to be more secure.</p>
<p>We can also plot boxplots to visualize the distribution of the variables</p>
<div id="cell-44" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:55.826123Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:55.825870Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:56.501674Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:56.500798Z&quot;}" data-execution_count="23">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>selector <span class="op">=</span> [<span class="st">'distance_from_home'</span>, <span class="st">'distance_from_last_transaction'</span>, <span class="st">'ratio_to_median_purchase_price'</span>] <span class="co"># Select the variables we want to plot</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.boxplot(data <span class="op">=</span> df[selector], orient <span class="op">=</span> <span class="st">'h'</span>) </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xscale <span class="op">=</span> <span class="st">"log"</span>) <span class="co"># Set the x-axis to a logarithmic scale to better visualize the data</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="basics_files/figure-html/notebooks-basic_concepts-cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Boxplots are a good way to visualize the distribution of a variable, as they show the median, the interquartile range, and the outliers. Each of the distributions shown in the boxplots above has a long right tail, which explains the large number of outliers. However, you have to be careful: you cannot just remove these outliers since these are likely to be fraudulent transactions.</p>
<p>Letâ€™s see how many fraudulent transactions we would remove if we blindly remove the outliers according to the interquartile range</p>
<div id="cell-46" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:56.504653Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:56.504436Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:56.545951Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:56.545332Z&quot;}" data-execution_count="24">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the interquartile range</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>Q1 <span class="op">=</span> df[<span class="st">'ratio_to_median_purchase_price'</span>].quantile(<span class="fl">0.25</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>Q3 <span class="op">=</span> df[<span class="st">'ratio_to_median_purchase_price'</span>].quantile(<span class="fl">0.75</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify outliers based on the interquartile range</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>threshold <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>outliers <span class="op">=</span> df[(df[<span class="st">'ratio_to_median_purchase_price'</span>] <span class="op">&lt;</span> Q1 <span class="op">-</span> threshold <span class="op">*</span> IQR) <span class="op">|</span> (df[<span class="st">'ratio_to_median_purchase_price'</span>] <span class="op">&gt;</span> Q3 <span class="op">+</span> threshold <span class="op">*</span> IQR)]</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of fraudulent transactions amoung our selected outliers</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>outliers[<span class="st">'fraud'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>fraud
1.0    53092
0.0    31294
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="cell-47" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:56.548975Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:56.548724Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:56.565229Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:56.564612Z&quot;}" data-execution_count="25">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'fraud'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>fraud
0.0    912597
1.0     87403
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>53092 of 87403 (more than half!) of our fraudulent transactions would be removed if we would have blindly removed the outliers according to the interquartile range. This is a significant number of observations, which would likely hurt the performance of our machine-learning model. Therefore, we should not remove these outliers. It would make the imbalance of our dataset even worse.</p>
</section>
<section id="splitting-the-data-into-training-and-test-sets" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="splitting-the-data-into-training-and-test-sets">Splitting the Data into Training and Test Sets</h4>
<p>Before we can train a machine learning model, we need to split our dataset into a training set and a test set.</p>
<div id="cell-49" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:56.568155Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:56.567851Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:56.582410Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:56.581747Z&quot;}" data-execution_count="26">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">'fraud'</span>, axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># All variables except `fraud`</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'fraud'</span>] <span class="co"># Only our fraud variables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The training set is used to train the model, while the test set is used to evaluate the model. We will use the <code>train_test_split</code> function from the <code>sklearn.model_selection</code> module to split our dataset. We will use 70% of the data for training and 30% for testing. We will also set the <code>stratify</code> argument to <code>y</code> to make sure that the distribution of the target variable is the same in the training and test sets. Otherwise, we might randomly not have any fraudulent transactions in the test set, which would make it impossible to correctly evaluate our model.</p>
<div id="cell-51" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:56.585574Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:56.585339Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:56.959507Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:56.958629Z&quot;}" data-execution_count="27">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, stratify<span class="op">=</span>y, test_size <span class="op">=</span> <span class="fl">0.3</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scaling-features" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="scaling-features">Scaling Features</h4>
<p>To improve the performance of our machine learning model, we should scale the features. This is especially important for models that are sensitive to the scale of the features, such as logistic regression. We will use the <code>StandardScaler</code> class from the <code>sklearn.preprocessing</code> module to scale the features. The <code>StandardScaler</code> class scales the features so that they have a mean of 0 and a standard deviation of 1. Since we donâ€™t want to scale features that are binary (0 or 1), we will define a small function that scales only the features that we want</p>
<div id="cell-53" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:56.963787Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:56.963460Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:56.969611Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:56.968901Z&quot;}" data-execution_count="28">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scale_features(scaler, df, col_names, only_transform<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the features we want to scale</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    features <span class="op">=</span> df[col_names] </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the scaler to the features and transform them</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> only_transform:</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> scaler.transform(features.values)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> scaler.fit_transform(features.values)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Replace the original features with the scaled features</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    df[col_names] <span class="op">=</span> features</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we need to run the function</p>
<div id="cell-55" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:56.973288Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:56.972984Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:57.022303Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:57.021529Z&quot;}" data-execution_count="29">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>col_names <span class="op">=</span> [<span class="st">'distance_from_home'</span>, <span class="st">'distance_from_last_transaction'</span>, <span class="st">'ratio_to_median_purchase_price'</span>] </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler() </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>scale_features(scaler, X_train, col_names)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>scale_features(scaler, X_test, col_names, only_transform<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that we only fit the scaler to the training set and then transform both the training and test set. This ensures that the same values for the features produce the same output in the training and test set. Otherwise, if we fit the scaler to the test data as well, the meaning of certain values in the test set might change, which would make it impossible to evaluate the model correctly.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mini-Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Try switching to <code>MinMaxScaler</code> instead of <code>StandardScaler</code> and see how it affects the performance of the model. <code>MinMaxScaler</code> scales the features so that they are between 0 and 1.</p>
</div>
</div>
</section>
</section>
<section id="implementing-logistic-regression" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="implementing-logistic-regression"><span class="header-section-number">2.5.2</span> Implementing Logistic Regression</h3>
<p>Now that we have explored and preprocessed our dataset, we can move on to the next step: training a machine learning model. We will use a logistic regression model to predict whether a transaction is fraudulent or not.</p>
<p>Using the <code>LogisticRegression</code> class from the <code>sklearn.linear_model</code> module, fitting the model to the data is straightforward using the <code>fit</code> method</p>
<div id="cell-57" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:57.026348Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:57.026049Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:58.024034Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:58.023354Z&quot;}" data-execution_count="30">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LogisticRegression().fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then use the <code>predict</code> method to predict the class of the test set</p>
<div id="cell-59" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:58.027609Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:58.027373Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:58.034159Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:58.033449Z&quot;}" data-execution_count="31">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>clf.predict(X_test.head(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>array([0., 0., 0., 0., 1.])</code></pre>
</div>
</div>
<p>The actual classes of the first five observations in the test dataset are</p>
<div id="cell-61" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:58.037291Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:58.037074Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:58.041770Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:58.040998Z&quot;}" data-execution_count="32">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>y_test.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>217309    0.0
902387    0.0
175152    0.0
527113    0.0
973041    1.0
Name: fraud, dtype: float64</code></pre>
</div>
</div>
<p>This seems to match quite well. Letâ€™s have a look at different performance metrics</p>
<div id="cell-63" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:58.045196Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:58.044924Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:58.437017Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:58.436505Z&quot;}" data-execution_count="33">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> clf.predict(X_test)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>y_proba <span class="op">=</span> clf.predict_proba(X_test)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy: </span><span class="sc">{</span>accuracy_score(y_test, y_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Precision: </span><span class="sc">{</span>precision_score(y_test, y_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Recall: </span><span class="sc">{</span>recall_score(y_test, y_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"ROC AUC: </span><span class="sc">{</span>roc_auc_score(y_test, y_proba[:, <span class="dv">1</span>])<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.95908
Precision: 0.8954682094038908
Recall: 0.6021128103428549
ROC AUC: 0.9671832218100465</code></pre>
</div>
</div>
<p>As expected, the accuracy is quite high since we do not have many fraudulent transactions. Recall that the precision (<span class="math inline">\(\text{Precision} = \frac{\text{TP}}{\text{TP}+\text{FP}}\)</span>) is the fraction of correctly predicted fraudulent transactions among all transactions transactions predicted to be fraudulent. The recall (<span class="math inline">\(\text{Recall} = \frac{\text{TP}}{\text{TP}+\text{FN}}\)</span>) is the fraction of correctly predicted fraudulent transactions among the actual fraudulent transactions. The ROC AUC is the area under the curve for the receiver operating characteristic (ROC) curve</p>
<div id="cell-65" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:58.439921Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:58.439702Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:58.703398Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:58.702875Z&quot;}" data-execution_count="34">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the ROC curve</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>y_proba <span class="op">=</span> clf.predict_proba(X_test)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresholds <span class="op">=</span> roc_curve(y_test, y_proba[:,<span class="dv">1</span>])</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the ROC curve</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr, tpr)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'grey'</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'False Positive Rate (FPR)'</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'True Positive Rate (TPR)'</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'ROC Curve'</span>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="basics_files/figure-html/notebooks-basic_concepts-cell-35-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The confusion matrix for the test set can be computed as follows</p>
<div id="cell-67" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:58.706426Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:58.706048Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:58.900087Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:58.898792Z&quot;}" data-execution_count="35">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>conf_mat <span class="op">=</span> confusion_matrix(y_test, y_pred, labels<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">0</span>]).transpose() <span class="co"># Transpose the sklearn confusion matrix to match the convention in the lecture</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>conf_mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>array([[ 15788,   1843],
       [ 10433, 271936]])</code></pre>
</div>
</div>
<p>We can also plot the confusion matrix as a heatmap</p>
<div id="cell-69" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:58.903072Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:58.902844Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:59.037509Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:59.036661Z&quot;}" data-execution_count="36">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>sns.heatmap(conf_mat, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>, fmt<span class="op">=</span><span class="st">'g'</span>, xticklabels<span class="op">=</span>[<span class="st">'Fraud'</span>, <span class="st">'No Fraud'</span>], yticklabels<span class="op">=</span>[<span class="st">'Fraud'</span>, <span class="st">'No Fraud'</span>])</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Actual"</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Predicted"</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="basics_files/figure-html/notebooks-basic_concepts-cell-37-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As you can see, we have mostly true negatives and true positives. However, there is still a significant number of false negatives, which means that we are missing fraudulent transactions, and a significant number of false positives, which means that we are predicting transactions as fraudulent that are not fraudulent.</p>
<p>If we would like to use a threshold other than 0.5 to predict the class of the test set, we can do so as follows</p>
<div id="cell-71" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:59.040542Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:59.040333Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:53:59.320539Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:53:59.319960Z&quot;}" data-execution_count="37">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative threshold</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>threshold <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict the class of the test set</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>y_pred_alt <span class="op">=</span> (y_proba[:, <span class="dv">1</span>] <span class="op">&gt;=</span> threshold).astype(<span class="bu">int</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the performance metrics</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy: </span><span class="sc">{</span>accuracy_score(y_test, y_pred_alt)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Precision: </span><span class="sc">{</span>precision_score(y_test, y_pred_alt)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Recall: </span><span class="sc">{</span>recall_score(y_test, y_pred_alt)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.9112033333333334
Precision: 0.49579121188932296
Recall: 0.9389420693337401</code></pre>
</div>
</div>
<p>Setting a lower threshold increases the recall but decreases the precision. This is because we are more likely to predict a transaction as fraudulent, which increases the number of true positives but also the number of false positives.</p>
<p>What the correct threshold is depends on the problem at hand. For example, if the cost of missing a fraudulent transaction is very high, you might want to set a lower threshold to increase the recall. If the cost of falsely predicting a transaction as fraudulent is very high, you might want to set a higher threshold to increase the precision.</p>
<p>We can also plot the performance metrics for different thresholds</p>
<div id="cell-73" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-31T16:53:59.323587Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-31T16:53:59.323329Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T16:54:12.607865Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T16:54:12.607332Z&quot;}" data-execution_count="38">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>thresholds_array <span class="op">=</span> np.linspace(<span class="fl">0.0</span>, <span class="fl">0.999</span>, N)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>accuracy_array <span class="op">=</span> np.zeros(N)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>precision_array <span class="op">=</span> np.zeros(N)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>recall_array <span class="op">=</span> np.zeros(N)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the performance metrics for different thresholds</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ii, thresh <span class="kw">in</span> <span class="bu">enumerate</span>(thresholds_array):</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    y_pred_alt_tmp <span class="op">=</span> (y_proba[:, <span class="dv">1</span>] <span class="op">&gt;</span> thresh).astype(<span class="bu">int</span>)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    accuracy_array[ii] <span class="op">=</span> accuracy_score(y_test, y_pred_alt_tmp)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    precision_array[ii] <span class="op">=</span> precision_score(y_test, y_pred_alt_tmp)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    recall_array[ii] <span class="op">=</span> recall_score(y_test, y_pred_alt_tmp)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the performance metrics</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>plt.plot(thresholds_array, accuracy_array, label<span class="op">=</span><span class="st">'Accuracy'</span>)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>plt.plot(thresholds_array, precision_array, label<span class="op">=</span><span class="st">'Precision'</span>)</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>plt.plot(thresholds_array, recall_array, label<span class="op">=</span><span class="st">'Recall'</span>)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Threshold'</span>)</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Score'</span>)</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="basics_files/figure-html/notebooks-basic_concepts-cell-39-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusions" class="level3" data-number="2.5.3">
<h3 data-number="2.5.3" class="anchored" data-anchor-id="conclusions"><span class="header-section-number">2.5.3</span> Conclusions</h3>
<p>In this notebook, we have seen how to implement a logistic regression model in Python. We have loaded a dataset, explored and preprocessed it, and trained a logistic regression model to predict whether a transaction is fraudulent or not. We have evaluated the model using different performance metrics and have seen how the choice of threshold affects the performance of the model.</p>
<p>There are many ways to improve the performance of the model. For example, we could try different machine learning models, or engineer new features. We could also try to deal with the imbalanced dataset by using techniques such as oversampling or undersampling. However, this is beyond the scope of this notebook.</p>
<!--
Potential Datasets:

- Audit Data (https://www.kaggle.com/datasets/sid321axn/audit-data)
- Credit Card Fraud Detection (https://www.kaggle.com/datasets/dhanushnarayananr/credit-card-fraud/data)
- Bank Account Fraud (https://www.kaggle.com/datasets/sgpjesus/bank-account-fraud-dataset-neurips-2022)

Beginner datasets:
https://www.kaggle.com/discussions/getting-started/196714

-->
</section>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Hastie2009" class="csl-entry" role="listitem">
Hastie, Trevor, Robert Tibshirani, and Jerome Friedman. 2009. <em><span class="nocase">The Elements of Statistical Learning - Data Mining, Inference, and Prediction</span></em>. Second Edition. Springer.
</div>
</div>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ilxue1xuXHQvL1xuXHRjb25zdCByYW5kb21EYXRhUmFuZ2UgPSBbLTQsIDRdO1xuXHRjb25zdCBsb3NzUmFuZ2UgPSBbMCwgMTFdO1xuXG5cdC8vIEdlbmVyYXRlIHJhbmRvbSBkYXRhXG5cdGNvbnN0IHNlZWQgPSAwLjI1MTYwMzg2OTExMTIwNTI1OyAvLyBhIG51bWJlciBpbiBbMCwxKVxuXHRjb25zdCBzb3VyY2UgPSBkMy5yYW5kb21MY2coc2VlZCk7XG5cdGNvbnN0IHJhbmRuID0gZDMucmFuZG9tTm9ybWFsLnNvdXJjZShzb3VyY2UpKDAsIDEpO1xuXHRsZXQgeFRtcCA9IEFycmF5LmZyb20oe2xlbmd0aDogMTAwfSwgcmFuZG4pO1xuXHRsZXQgeVRtcCA9IEFycmF5LmZyb20oe2xlbmd0aDogMTAwfSwgcmFuZG4pO1xuXHRsZXQgcmFuZG9tRGF0YSA9IHByZXBhcmVEYXRhKHhUbXAsIHlUbXApO1xuXG5cdGZ1bmN0aW9uIHByZXBhcmVEYXRhKHhUbXAsIHlUbXApIHtcblxuXHRcdGxldCBkYXRhID0gW107XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHhUbXAubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdGxldCBkYXRhUG9pbnQgPSB7XCJ4XCI6IHhUbXBbaV0sIFwieVwiOiB4VG1wW2ldICsgeVRtcFtpXX07XG5cdFx0XHRkYXRhLnB1c2goZGF0YVBvaW50KVxuXHRcdH1cblxuXHRcdHJldHVybiBkYXRhO1xuXG5cdH1cblxuXHQvLyBMb3NzIGZ1bmN0aW9uXG5cdGZ1bmN0aW9uIHN1bU9mU3F1YXJlcyhzbG9wZSkge1xuXG5cdFx0bGV0IHN1bSA9IDA7XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHJhbmRvbURhdGEubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdHN1bSArPSAocmFuZG9tRGF0YVtpXS55IC0gc2xvcGUgKiByYW5kb21EYXRhW2ldLngpICoqIDIgLyByYW5kb21EYXRhLmxlbmd0aDtcblx0XHR9XG5cblx0XHRyZXR1cm4gc3VtO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBjb21wdXRlTG9zc0N1cnZlKGlucHV0UmFuZ2UpIHtcblxuXHRcdGxldCBsb3NzID0gW107XG5cdFx0bGV0IE4gPSAxMDA7XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8PSAxMDA7IGkgKz0gMSkge1xuXHRcdFx0bGV0IHggPSBpbnB1dFJhbmdlWzBdICsgaSAqIChpbnB1dFJhbmdlWzFdIC0gaW5wdXRSYW5nZVswXSkvMTAwXG5cdFx0XHRsZXQgZGF0YVBvaW50ID0ge1wieFwiOiB4LCBcInlcIjogc3VtT2ZTcXVhcmVzKHgpfTtcblx0XHRcdGxvc3MucHVzaChkYXRhUG9pbnQpXG5cdFx0fVxuXG5cdFx0cmV0dXJuIGxvc3M7XG5cblx0fVxuXG5cdC8vIERhdGEgZm9yIHJlZ3Jlc3Npb24gbGluZVxuXHRsZXQgc2xvcGVEYXRhID0gW1xuXHRcdHt4OiAoc2xvcGUgPiAxIHx8IHNsb3BlIDwgLTEpICA/IHJhbmRvbURhdGFSYW5nZVswXS9zbG9wZSA6IHJhbmRvbURhdGFSYW5nZVswXSwgeTogKHNsb3BlID4gMSB8fCBzbG9wZSA8IC0xKSAgPyByYW5kb21EYXRhUmFuZ2VbMF0gOiByYW5kb21EYXRhUmFuZ2VbMF0qc2xvcGV9LFxuXHRcdHt4OiAoc2xvcGUgPiAxIHx8IHNsb3BlIDwgLTEpICA/IHJhbmRvbURhdGFSYW5nZVsxXS9zbG9wZSA6IHJhbmRvbURhdGFSYW5nZVsxXSwgeTogKHNsb3BlID4gMSB8fCBzbG9wZSA8IC0xKSAgPyByYW5kb21EYXRhUmFuZ2VbMV0gOiByYW5kb21EYXRhUmFuZ2VbMV0qc2xvcGV9XG5cdF07XG5cblx0Ly8gRGF0YSBmb3IgbG9zcyBtYXJrZXJcblx0bGV0IG1hcmtlckRhdGEgPSBbXG5cdFx0e3g6IHNsb3BlLCB5OiBzdW1PZlNxdWFyZXMoc2xvcGUpIH1cblx0XTtcblxuXHQvLyBEYXRhIGZvciBsb3NzIGN1cnZlXG5cdGxldCBsb3NzQ3VydmVEYXRhID0gY29tcHV0ZUxvc3NDdXJ2ZShpbnB1dFJhbmdlKTtcblxuXHRjb25zdCBzZXRzID0gWzEsIDJdO1xuXHRyZXR1cm4gaHRtbGA8ZGl2IHN0eWxlPVwiZGlzcGxheTpmbGV4OyBmbGV4LXdyYXA6IHdyYXA7XCI+XG5cdCR7c2V0c1xuXHQubWFwKChpbmRleCkgPT5cblx0XHRQbG90LnBsb3Qoe1xuXHRcdFx0bWFyZ2luTGVmdDogNDAsXG5cdFx0XHRtYXJnaW5Ub3A6IDIwLFxuXHRcdFx0d2lkdGg6IHdpZHRoIC8gMiAtIDIsXG5cdFx0XHRoZWlnaHQ6IHdpZHRoIC8gMyAtIDIsXG5cdFx0XHR4OiB7IGRvbWFpbjogaW5kZXggPT09IDEgPyByYW5kb21EYXRhUmFuZ2UgOiBpbnB1dFJhbmdlLCBsYWJlbDogaW5kZXggPT09IDEgPyBcInhcIiA6IFwiV2VpZ2h0XCJ9LFxuXHRcdFx0eTogeyBkb21haW46IGluZGV4ID09PSAxID8gcmFuZG9tRGF0YVJhbmdlIDogbG9zc1JhbmdlLCBsYWJlbDogaW5kZXggPT09IDEgPyBcInlcIiA6IFwiTG9zc1wifSxcblx0XHRcdG1hcmtzOiBbXG5cdFx0XHRcdFBsb3QuZnJhbWUoKSxcblx0XHRcdFx0aW5kZXggPT09IDFcblx0XHRcdFx0XHQ/IFBsb3QuZG90KHJhbmRvbURhdGEsIHt4OiBcInhcIiwgeTogXCJ5XCIsIGZpbGw6IFwic3RlZWxibHVlXCJ9KVxuXHRcdFx0XHRcdDogUGxvdC5saW5lKGxvc3NDdXJ2ZURhdGEsIHt4OiBcInhcIiwgeTogXCJ5XCIsIHN0cm9rZTogXCJzdGVlbGJsdWVcIn0pLFxuXHRcdFx0XHRpbmRleCA9PT0gMVxuXHRcdFx0XHRcdD8gUGxvdC5saW5lKHNsb3BlRGF0YSwge3g6IFwieFwiLCB5OiBcInlcIiwgc3Ryb2tlOiBcInJlZFwifSlcblx0XHRcdFx0XHQ6IFBsb3QuZG90KG1hcmtlckRhdGEsIHt4OiBcInhcIiwgeTogXCJ5XCIsIGZpbGw6IFwicmVkXCIsIHI6IDZ9KSxcblx0XHRcdFx0UGxvdC50ZXh0KFtpbmRleF0sIHtcblx0XHRcdFx0XHR4OiBpbmRleCA9PT0gMSA/IChyYW5kb21EYXRhUmFuZ2VbMV0gKyByYW5kb21EYXRhUmFuZ2VbMF0pLzIgOiAoaW5wdXRSYW5nZVsxXSArIGlucHV0UmFuZ2VbMF0pLzIsXG5cdFx0XHRcdFx0eTogaW5kZXggPT09IDEgPyAoKHJhbmRvbURhdGFSYW5nZVsxXSAtIHJhbmRvbURhdGFSYW5nZVswXSkgKiAwLjEgKyByYW5kb21EYXRhUmFuZ2VbMV0pIDogKChsb3NzUmFuZ2VbMV0gLSBsb3NzUmFuZ2VbMF0pICogMC4xICsgbG9zc1JhbmdlWzFdKSxcblx0XHRcdFx0XHR0ZXh0OiAoZCkgPT4gaW5kZXggPT09IDEgPyBcIkRhdGEgKyBSZWdyZXNzaW9uIExpbmVcIiA6IFwiTWVhbiBTcXVhcmVkIEVycm9yIChNU0UpXCIsXG5cdFx0XHRcdFx0dGV4dEFuY2hvcjogXCJtaWRkbGVcIlxuXHRcdFx0XHR9KVxuXHRcdFx0XSxcblx0XHRcdG5pY2U6IHRydWVcblx0XHR9KVxuXHQpXG5cdC5mbGF0KCl9YDtcbn1cblxuLy8gSW5wdXQgc2xpZGVyXG5pbnB1dFJhbmdlID0gWy0yLCA0XTtcbnZpZXdvZiBzbG9wZSA9IElucHV0cy5yYW5nZShpbnB1dFJhbmdlLCB7bGFiZWw6IFwiV2VpZ2h0ICh3KVwiLCBzdGVwOiAwLjAxfSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Intcblx0Ly9cblx0Y29uc3QgcmFuZG9tRGF0YVJhbmdlID0gWy0yLCAyXTtcblx0Y29uc3QgbG9nbGlrZWxpaG9vZFJhbmdlID0gWy0yMCwgLThdO1xuXG5cdC8vIEdlbmVyYXRlIHJhbmRvbSBkYXRhXG5cdGNvbnN0IHNlZWQgPSAwLjI1MTYwMzg2OTExMTIwNTI1OyAvLyBhIG51bWJlciBpbiBbMCwxKVxuXHRjb25zdCBzb3VyY2UgPSBkMy5yYW5kb21MY2coc2VlZCk7XG5cdGNvbnN0IHJhbmQgPSBkMy5yYW5kb21Vbmlmb3JtLnNvdXJjZShzb3VyY2UpKCk7XG5cdGxldCB4VG1wID0gQXJyYXkuZnJvbSh7bGVuZ3RoOiAxMDB9LCByYW5kKS5tYXAoKHgpID0+IDQqeC0yKTtcblx0bGV0IHBUbXAgPSB4VG1wLm1hcCgoeCkgPT4gMS8oMStNYXRoLmV4cCgtOCp4KSkpO1xuXHRsZXQgY1RtcCA9IHhUbXAubWFwKCh4KSA9PiAoMS8oMStNYXRoLmV4cCgtc2xvcGUyKngpKSA+PSB0aHJlc2hvbGRWYWx1ZSkgPyAxIDogMCk7IC8vIENsYXNzaWZpY2F0aW9uIGJhc2VkIG9uIHRocmVzaG9sZCBhbmQgc2xvcGUyXG5cdGxldCB5VG1wID0gcFRtcC5tYXAoKHApID0+IEFycmF5LmZyb20oe2xlbmd0aDogMX0sIHJhbmQpWzBdIDwgcCA/IDEgOiAwKTtcblx0bGV0IHJhbmRvbURhdGEgPSBwcmVwYXJlRGF0YSh4VG1wLCB5VG1wLCBjVG1wKTtcblxuXHRmdW5jdGlvbiBwcmVwYXJlRGF0YSh4VG1wLCB5VG1wLCBjVG1wKSB7XG5cblx0XHRsZXQgZGF0YSA9IFtdO1xuXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB4VG1wLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRsZXQgZGF0YVBvaW50ID0ge1wieFwiOiB4VG1wW2ldLCBcInlcIjogeVRtcFtpXSwgXCJjbGFzc1wiOiBjVG1wW2ldfTtcblx0XHRcdGRhdGEucHVzaChkYXRhUG9pbnQpXG5cdFx0fVxuXG5cdFx0cmV0dXJuIGRhdGE7XG5cblx0fVxuXG5cdC8vIFJlZ3Jlc3Npb24gbGluZVxuXHRsZXQgcmVnRGF0YSA9IGNvbXB1dGVMb2dpc3RpY1JlZ3Jlc3Npb25MaW5lKHNsb3BlMiwgcmFuZG9tRGF0YVJhbmdlLCAxMDApXG5cblx0ZnVuY3Rpb24gY29tcHV0ZUxvZ2lzdGljUmVncmVzc2lvbkxpbmUoc2xvcGUsIGlucHV0UmFuZ2UsIE4pIHtcblxuXHRcdGxldCBkYXRhID0gW107XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8PSBOOyBpICs9IDEpIHtcblx0XHRcdGxldCB4ID0gaW5wdXRSYW5nZVswXSArIGkgKiAoaW5wdXRSYW5nZVsxXSAtIGlucHV0UmFuZ2VbMF0pLzEwMDtcblx0XHRcdGxldCBkYXRhUG9pbnQgPSB7XCJ4XCI6IHgsIFwieVwiOiAxLygxK01hdGguZXhwKC1zbG9wZSp4KSl9O1xuXHRcdFx0ZGF0YS5wdXNoKGRhdGFQb2ludCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGRhdGE7XG5cblx0fVxuXG5cdC8vIExvZy1saWtlbGlob29kIGZ1bmN0aW9uXG5cdGZ1bmN0aW9uIGNvbXB1dGVMb2dMaWtlbGlob29kKHNsb3BlLCBkYXRhKSB7XG5cblx0XHRsZXQgbG9nbGlrZWxpaG9vZCA9IDA7XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdGxvZ2xpa2VsaWhvb2QgKz0gZGF0YVtpXS55ICogTWF0aC5sb2coMS8oMStNYXRoLmV4cCgtc2xvcGUqZGF0YVtpXS54KSkpICsgKDEtZGF0YVtpXS55KSAqIE1hdGgubG9nKDEtMS8oMStNYXRoLmV4cCgtc2xvcGUqZGF0YVtpXS54KSkpO1xuXHRcdH1cblxuXHRcdHJldHVybiBsb2dsaWtlbGlob29kO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBjb21wdXRlTG9zc0N1cnZlKGlucHV0UmFuZ2UsIGRhdGEsIE4pIHtcblxuXHRcdGxldCBsb3NzID0gW107XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8PSBOOyBpICs9IDEpIHtcblx0XHRcdGxldCB4ID0gaW5wdXRSYW5nZVswXSArIGkgKiAoaW5wdXRSYW5nZVsxXSAtIGlucHV0UmFuZ2VbMF0pLzEwMDtcblx0XHRcdGxldCBkYXRhUG9pbnQgPSB7XCJ4XCI6IHgsIFwieVwiOiBjb21wdXRlTG9nTGlrZWxpaG9vZCh4LCBkYXRhKX07XG5cdFx0XHRsb3NzLnB1c2goZGF0YVBvaW50KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gbG9zcztcblxuXHR9XG5cblx0bGV0IGxvZ2xpa2VsaWhvb2RDdXJ2ZURhdGEgPSBjb21wdXRlTG9zc0N1cnZlKGlucHV0UmFuZ2UyLCByYW5kb21EYXRhLCAxMDApO1xuXHRsZXQgbWFya2VyRGF0YSA9IFtcblx0XHR7eDogc2xvcGUyLCB5OiBjb21wdXRlTG9nTGlrZWxpaG9vZChzbG9wZTIsIHJhbmRvbURhdGEpIH1cblx0XTtcblxuXHQvLyBEYXRhIGZvciB0aHJlc2hvbGRcblx0bGV0IHRocmVzaERhdGEgPSBbXG5cdFx0e3g6IHJhbmRvbURhdGFSYW5nZVswXSwgeTogdGhyZXNob2xkVmFsdWV9LFxuXHRcdHt4OiByYW5kb21EYXRhUmFuZ2VbMV0sIHk6IHRocmVzaG9sZFZhbHVlfVxuXHRdO1xuXG5cdGNvbnN0IHNldHMgPSBbMSwgMl07XG5cdHJldHVybiBodG1sYDxkaXYgc3R5bGU9XCJkaXNwbGF5OmZsZXg7IGZsZXgtd3JhcDogd3JhcDtcIj5cblx0JHtzZXRzXG5cdC5tYXAoKGluZGV4KSA9PlxuXHRcdFBsb3QucGxvdCh7XG5cdFx0XHRtYXJnaW5MZWZ0OiA0MCxcblx0XHRcdG1hcmdpblRvcDogMjAsXG5cdFx0XHR3aWR0aDogd2lkdGggLyAyIC0gMixcblx0XHRcdGhlaWdodDogd2lkdGggLyAzIC0gMixcblx0XHRcdHg6IHsgZG9tYWluOiBpbmRleCA9PT0gMSA/IFstMiwgMl0gOiBpbnB1dFJhbmdlMiwgbGFiZWw6IGluZGV4ID09PSAxID8gXCJYXCIgOiBcIldlaWdodFwifSxcblx0XHRcdHk6IHsgZG9tYWluOiBpbmRleCA9PT0gMSA/IFswLCAxXSA6IGxvZ2xpa2VsaWhvb2RSYW5nZSwgbGFiZWw6IGluZGV4ID09PSAxID8gXCJZXCIgOiBcImxvZyhMKHcsYikpXCJ9LFxuXHRcdFx0Y29sb3I6IHtcblx0XHRcdFx0ZG9tYWluOiBbMCwgMV0sXG5cdFx0XHRcdHNjaGVtZTogXCJQYWlyZWRcIlxuXHRcdFx0fSxcblx0XHRcdG1hcmtzOiBbXG5cdFx0XHRcdFBsb3QuZnJhbWUoKSxcblx0XHRcdFx0aW5kZXggPT09IDFcblx0XHRcdFx0XHQ/IFBsb3QuZG90KHJhbmRvbURhdGEsIHt4OiBcInhcIiwgeTogXCJ5XCIsIHI6IDQsIGZpbGw6IHRocmVzaG9sZC5pbmNsdWRlcyhcIlwiKSA/IFwiY2xhc3NcIiA6IFwic3RlZWxibHVlXCJ9KVxuXHRcdFx0XHRcdDogUGxvdC5saW5lKGxvZ2xpa2VsaWhvb2RDdXJ2ZURhdGEsIHt4OiBcInhcIiwgeTogXCJ5XCIsIHN0cm9rZTogXCJzdGVlbGJsdWVcIn0pLFxuXHRcdFx0XHRpbmRleCA9PT0gMVxuXHRcdFx0XHRcdD8gUGxvdC5saW5lKHJlZ0RhdGEsIHt4OiBcInhcIiwgeTogXCJ5XCIsIHN0cm9rZTogXCJyZWRcIn0pXG5cdFx0XHRcdFx0OiBQbG90LmRvdChtYXJrZXJEYXRhLCB7eDogXCJ4XCIsIHk6IFwieVwiLCBmaWxsOiBcInJlZFwiLCByOiA2fSksXG5cdFx0XHRcdHRocmVzaG9sZC5pbmNsdWRlcyhcIlwiKVxuXHRcdFx0XHRcdD8gUGxvdC5saW5lKHRocmVzaERhdGEsIHt4OiBcInhcIiwgeTogXCJ5XCIsIHN0cm9rZTogXCJibGFja1wiLCBzdHJva2VEYXNoYXJyYXk6IFwiMTAsNVwifSlcblx0XHRcdFx0XHQ6IG51bGwsXG5cdFx0XHRcdFBsb3QudGV4dChbaW5kZXhdLCB7XG5cdFx0XHRcdFx0eDogaW5kZXggPT09IDEgPyAocmFuZG9tRGF0YVJhbmdlWzFdICsgcmFuZG9tRGF0YVJhbmdlWzBdKS8yIDogKGlucHV0UmFuZ2UyWzFdICsgaW5wdXRSYW5nZTJbMF0pLzIsXG5cdFx0XHRcdFx0eTogaW5kZXggPT09IDEgPyAxLjEgOiAoKGxvZ2xpa2VsaWhvb2RSYW5nZVsxXSAtIGxvZ2xpa2VsaWhvb2RSYW5nZVswXSkgKiAwLjEgKyBsb2dsaWtlbGlob29kUmFuZ2VbMV0pLFxuXHRcdFx0XHRcdHRleHQ6IChkKSA9PiBpbmRleCA9PT0gMSA/IFwiRGF0YSArIFJlZ3Jlc3Npb24gTGluZVwiIDogXCJMb2ctTGlrZWxpaG9vZFwiLFxuXHRcdFx0XHRcdHRleHRBbmNob3I6IFwibWlkZGxlXCJcblx0XHRcdFx0fSlcblx0XHRcdF0sXG5cdFx0XHRcblx0XHRcdG5pY2U6IHRydWVcblx0XHR9KVxuXHQpXG5cdC5mbGF0KCl9YDtcbn1cblxuLy8gSW5wdXQgc2xpZGVyXG5pbnB1dFJhbmdlMiA9IFstMiwgMThdO1xudmlld29mIHNsb3BlMiA9IElucHV0cy5yYW5nZShpbnB1dFJhbmdlMiwge2xhYmVsOiBcIldlaWdodCAodylcIiwgc3RlcDogMC4wMX0pXG52aWV3b2YgdGhyZXNob2xkID0gSW5wdXRzLmNoZWNrYm94KFtcIlwiXSwge2xhYmVsOiBcIkNsYXNzaWZpY2F0aW9uIFRocmVzaG9sZFwifSlcbnZpZXdvZiB0aHJlc2hvbGRWYWx1ZSA9IElucHV0cy5yYW5nZShbMCwxXSwge3ZhbHVlOiAwLjUsIGxhYmVsOiBcIlRocmVzaG9sZCBWYWx1ZSAodClcIiwgc3RlcDogMC4wMX0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG5cdC8vXG5cdGNvbnN0IHJhbmRvbURhdGFSYW5nZSA9IFstMiwgMl07XG5cdGNvbnN0IGxvZ2xpa2VsaWhvb2RSYW5nZSA9IFstMjAsIC04XTtcblxuXHQvLyBHZW5lcmF0ZSByYW5kb20gZGF0YVxuXHRjb25zdCBzZWVkID0gMC4yNTE2MDM4NjkxMTEyMDUyNTsgLy8gYSBudW1iZXIgaW4gWzAsMSlcblx0Y29uc3Qgc291cmNlID0gZDMucmFuZG9tTGNnKHNlZWQpO1xuXHRjb25zdCByYW5kID0gZDMucmFuZG9tVW5pZm9ybS5zb3VyY2Uoc291cmNlKSgpO1xuXHRsZXQgeDFUbXAgPSBBcnJheS5mcm9tKHtsZW5ndGg6IDIwMH0sIHJhbmQpLm1hcCgoeCkgPT4gKHJhbmRvbURhdGFSYW5nZVsxXSAtIHJhbmRvbURhdGFSYW5nZVswXSkgKiB4ICsgcmFuZG9tRGF0YVJhbmdlWzBdKTtcblx0bGV0IHgyVG1wID0gQXJyYXkuZnJvbSh7bGVuZ3RoOiAyMDB9LCByYW5kKS5tYXAoKHgpID0+IChyYW5kb21EYXRhUmFuZ2VbMV0gLSByYW5kb21EYXRhUmFuZ2VbMF0pICogeCArIHJhbmRvbURhdGFSYW5nZVswXSk7XG5cdGxldCBwVG1wID0geDFUbXAubWFwKCh4MSwgaSkgPT4gMS8oMStNYXRoLmV4cCgtMC41IC0gMyAqIHgxIC0gNCAqIHgyVG1wW2ldIC0gMiAqIE1hdGgucG93KHgxLCAyKSkpKTsgLy8gXCJUcnVlXCIgbW9kZWxcblx0Ly8odXNTcXVhcmUuaW5jbHVkZXMoXCJcIikgPyAyICogTWF0aC5wb3coeDEsIDIpIDogMClcblx0bGV0IHlUbXAgPSBwVG1wLm1hcCgocCkgPT4gQXJyYXkuZnJvbSh7bGVuZ3RoOiAxfSwgcmFuZClbMF0gPCBwID8gMSA6IDApO1xuXHRsZXQgcmFuZG9tRGF0YSA9IHByZXBhcmVEYXRhKHlUbXAsIHgxVG1wLCB4MlRtcCk7XG5cblx0ZnVuY3Rpb24gcHJlcGFyZURhdGEoeVRtcCwgeDFUbXAsIHgyVG1wKSB7XG5cblx0XHRsZXQgZGF0YSA9IFtdO1xuXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB4MVRtcC5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0bGV0IGRhdGFQb2ludCA9IHtcIngxXCI6IHgxVG1wW2ldLCBcIngyXCI6IHgyVG1wW2ldLCBcInlcIjogeVRtcFtpXX07XG5cdFx0XHRkYXRhLnB1c2goZGF0YVBvaW50KVxuXHRcdH1cblxuXHRcdHJldHVybiBkYXRhO1xuXG5cdH1cblxuXHQvLyBEZWNpc2lvbiBib3VuZGFyeVxuXHRsZXQgcmVnRGF0YSA9IGNvbXB1dGVEZWNpc2lvbkJvdW5kYXJ5KHdlaWdodDEsIHdlaWdodDIsIHdlaWdodDMsIGJpYXMsIDAuNSwgcmFuZG9tRGF0YVJhbmdlLCAxMDApXG5cblx0ZnVuY3Rpb24gY29tcHV0ZURlY2lzaW9uQm91bmRhcnkodzEsIHcyLCB3MywgYiwgdCwgaW5wdXRSYW5nZSwgTikge1xuXG5cdFx0bGV0IGRhdGEgPSBbXTtcblxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDw9IE47IGkgKz0gMSkge1xuXHRcdFx0bGV0IHgxID0gaW5wdXRSYW5nZVswXSArIGkgKiAoaW5wdXRSYW5nZVsxXSAtIGlucHV0UmFuZ2VbMF0pLzEwMDtcblx0XHRcdGxldCB4MiA9IDEvdzIgKiAoLWIgLSB3MSAqIHgxIC0gKHVzZVNxdWFyZS5pbmNsdWRlcyhcIlwiKSA/IHczICogTWF0aC5wb3coeDEsMikgIDogMCkgLSBNYXRoLmxvZygoMS10KS90KSk7XG5cdFx0XHR4MiA9IE1hdGgubWluKE1hdGgubWF4KHgyLCBpbnB1dFJhbmdlWzBdKSwgaW5wdXRSYW5nZVsxXSlcblx0XHRcdGxldCBjID0gMS8oMStNYXRoLmV4cCgtYiAtIHcxICogeDEgLSB3MiAqIHgyIC0gMiAqIE1hdGgucG93KHgxLCAyKSArIDMgKiBNYXRoLnBvdyh4MSwgMykpIDwgdCA/IDAgOiAxKTtcblx0XHRcdGxldCBkYXRhUG9pbnQgPSB7XCJ4MVwiOiB4MSwgXCJ4MlwiOiB4MiwgXCJsYlwiOiBpbnB1dFJhbmdlWzBdLCBcInViXCI6IGlucHV0UmFuZ2VbMV0sIFwiYzBcIjogMCwgXCJjMVwiOiAxfTtcblx0XHRcdGRhdGEucHVzaChkYXRhUG9pbnQpO1xuXHRcdH1cblxuXHRcdHJldHVybiBkYXRhO1xuXG5cdH1cblxuXG5cdHJldHVybiBQbG90LnBsb3Qoe1xuXHRcdFx0bWFyZ2luTGVmdDogNDAsXG5cdFx0XHRtYXJnaW5Ub3A6IDIwLFxuXHRcdFx0d2lkdGg6IHdpZHRoIC0gMixcblx0XHRcdGhlaWdodDogd2lkdGggKiAyLzMgLSAyLFxuXHRcdFx0eDogeyBkb21haW46IHJhbmRvbURhdGFSYW5nZSwgbGFiZWw6IFwieOKCgVwifSxcblx0XHRcdHk6IHsgZG9tYWluOiByYW5kb21EYXRhUmFuZ2UsIGxhYmVsOiBcInjigoJcIn0sXG5cdFx0XHRjb2xvcjoge1xuXHRcdFx0XHRkb21haW46IFswLCAxXSxcblx0XHRcdFx0c2NoZW1lOiBcIkNhdGVnb3J5MTBcIlxuXHRcdFx0fSxcblx0XHRcdG1hcmtzOiBbXG5cdFx0XHRcdFBsb3QuZnJhbWUoKSxcblx0XHRcdFx0UGxvdC5kb3QocmFuZG9tRGF0YSwge3g6IFwieDFcIiwgeTogXCJ4MlwiLCByOiA0LCBmaWxsOiBcInlcIn0pLFxuXHRcdFx0XHRQbG90LmFyZWFZKHJlZ0RhdGEsIHt4OiBcIngxXCIsIHk6IFwieDJcIiwgeTI6IFwibGJcIiwgZmlsbDogXCJjMFwiLCBmaWxsT3BhY2l0eTogMC4yfSksXG5cdFx0XHRcdFBsb3QuYXJlYVkocmVnRGF0YSwge3g6IFwieDFcIiwgeTogXCJ4MlwiLCB5MjogXCJ1YlwiLCBmaWxsOiBcImMxXCIsIGZpbGxPcGFjaXR5OiAwLjJ9KSxcblx0XHRcdFx0UGxvdC5saW5lKHJlZ0RhdGEsIHt4OiBcIngxXCIsIHk6IFwieDJcIn0pXG5cdFx0XHRdLFxuXHRcdFx0XG5cdFx0XHRuaWNlOiB0cnVlXG5cdFx0fSlcbn1cblxuLy8gSW5wdXQgc2xpZGVyXG52aWV3b2Ygd2VpZ2h0MSA9IElucHV0cy5yYW5nZShbLTUsIDVdLCB7dmFsdWU6IDMsIGxhYmVsOiBcIldlaWdodCB34oKBXCIsIHN0ZXA6IDAuMDF9KVxudmlld29mIHdlaWdodDIgPSBJbnB1dHMucmFuZ2UoWzAuMSwgMTBdLCB7dmFsdWU6IDQsIGxhYmVsOiBcIldlaWdodCB34oKCXCIsIHN0ZXA6IDAuMDF9KVxudmlld29mIGJpYXMgPSBJbnB1dHMucmFuZ2UoWy0xMCwgMTBdLCB7dmFsdWU6IDAuNSwgbGFiZWw6IFwiQmlhcyBiXCIsIHN0ZXA6IDAuMDF9KVxudmlld29mIHVzZVNxdWFyZSA9IElucHV0cy5jaGVja2JveChbXCJcIl0sIHtsYWJlbDogXCJJbmNsdWRlIHNxdWFyZSBvZiB44oKBXCJ9KVxudmlld29mIHdlaWdodDMgPSBJbnB1dHMucmFuZ2UoWy01LCA1XSwge3ZhbHVlOiAyLCBsYWJlbDogXCJ34oKDXCIsIHN0ZXA6IDAuMDF9KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzbG9wZScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzbG9wZTInKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgndGhyZXNob2xkJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3RocmVzaG9sZFZhbHVlJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3dlaWdodDEnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnd2VpZ2h0MicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdiaWFzJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3VzZVNxdWFyZScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCd3ZWlnaHQzJykifV19
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./intro.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./decisiontrees.html" class="pagination-link" aria-label="Decision Trees">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Decision Trees</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>